packs:
  - uid: mondoo-macos-incident-response
    name: macOS Incident Response Pack
    version: 1.0.0
    authors:
      - name: Mondoo, Inc
        email: hello@mondoo.com
    tags:
      mondoo.com/platform: macos,host
      mondoo.com/category: security
    filters:
      - asset.platform == "macos"
    queries:
      - uid: mondoo-macos-incident-response-platform-info
        title: Retrieve platform information
        mql: platform { title release arch }
      - uid: mondoo-macos-incident-response-regular-users
        title: Retrieve regular users
        mql: users.where( name != /^_/ && shell != /\/usr\/bin\/false/ )
      - uid: mondoo-macos-incident-response-kernel-info
        title: Retrieve the running macOS kernel
        mql: kernel.info["version"]
      - uid: mondoo-macos-incident-response-kernel-modules
        title: Retrieve macOS kernel modules
        mql: kernel.modules { name loaded }
      - uid: mondoo-macos-incident-response-processes
        title: Retrieve running processes
        mql: processes.list { pid  command }
      - uid: mondoo-macos-incident-response-mounts
        title: Retrieve mounted devices
        mql: mount.list
      - uid: mondoo-macos-incident-response-uptime
        title: Retrieve operating system uptime
        mql: os.uptime
      - uid: mondoo-macos-incident-response-installed-packages
        title: Retrieve installed packages
        mql: packages
      - uid: mondoo-macos-incident-response-running-services
        title: Retrieve running services
        mql: services
      - uid: mondoo-macos-incident-response-alf-extensions
        title: Retrieve exceptions from the Application Layer Firewall
        mql: macos.alf.exceptions
      - uid: mondoo-macos-incident-response-check-recommended-updates
        title: Retrieve any recommended updates
        mql: parse.plist('/Library/Preferences/com.apple.SoftwareUpdate.plist').params['RecommendedUpdates']
