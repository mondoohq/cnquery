packs:
  - uid: mondoo-kubernetes-cluster-inventory
    name: Kubernetes Cluster Inventory Pack by Mondoo
    version: 1.1.0
    tags:
      mondoo.com/platform: kubernetes,k8s # remove k8s when v9 is released
      mondoo.com/category: best-practices
    docs:
      desc: |
        The Kubernetes Cluster Inventory Pack by Mondoo pack is designed to gather data about a Kubernetes Cluster for asset inventory. 

        To run this pack for a Kubernetes Cluster:

        ```bash
        cnquery scan k8s -f mondoo-kubernetes-inventory.mql.yaml
        ```

        ## Join the community!
        Our goal is to build query packs that are simple to deploy, and provide accurate and useful data. 
        
        If you have any suggestions on how to improve this query pack, or if you need support, [join the community](https://github.com/orgs/mondoohq/discussions) in GitHub Discussions. 
    filters:
      - asset.platform == "kubernetes" || asset.platform == "k8s-cluster"
    queries:
      - uid: k8s-cluster-version
        title: Gather Kubernetes Cluster Version
        query: |
          k8s.serverVersion
      - uid: k8s-cluster-namespaces
        title: Gather Kubernetes Cluster Namespaces
        query: |
          k8s.namespaces{ * }
      - uid: k8s-cluster-nodes
        title: Gather Cluster Nodes
        query: |
          k8s.nodes { * }
      - uid: k8s-cluster-clusterroles
        title: Gather Cluster RBAC ClusterRoles
        query: |
          k8s.clusterroles { * }      
  - uid: mondoo-kubernetes-pods-inventory
    name: Kubernetes Pods Inventory Pack by Mondoo
    version: 1.1.0
    tags:
      mondoo.com/platform: kubernetes,k8s # remove k8s when v9 is released
      mondoo.com/category: best-practices
    filters:
      - asset.platform == "k8s-pod"
    queries:
      - uid: k8s-pod
        title: Gather Pod Information
        query: |
          k8s.pod { * }
      - uid: k8s-pod-container
        title: Gather Container Information
        query: |
          k8s.pod.containers { * }
  - uid: mondoo-kubernetes-deployments-inventory
    name: Kubernetes Deployments Inventory Pack by Mondoo
    version: 1.1.0
    tags:
      mondoo.com/platform: kubernetes,k8s # remove k8s when v9 is released
      mondoo.com/category: best-practices
    filters:
      - asset.platform == "k8s-deployment"
    queries:
      - uid: k8s-deployment
        title: Gather Deployment Information
        query: |
          k8s.deployment { * }
      - uid: k8s-deployment-container
        title: Gather Container Information
        query: |
          k8s.deployment.containers { * }
  - uid: mondoo-kubernetes-cronjobs-inventory
    name: Kubernetes CronJobs Inventory Pack by Mondoo
    version: 1.1.0
    tags:
      mondoo.com/platform: kubernetes,k8s # remove k8s when v9 is released
      mondoo.com/category: best-practices
    filters:
      - asset.platform == "k8s-cronjob"
    queries:
      - uid: k8s-cronjob
        title: Gather CronJob Information
        query: |
          k8s.cronjob { * }
      - uid: k8s-cronjob-container
        title: Gather Container Information
        query: |
          k8s.cronjob.containers { * }
  - uid: mondoo-kubernetes-jobs-inventory
    name: Kubernetes Jobs Inventory Pack by Mondoo
    version: 1.1.0
    tags:
      mondoo.com/platform: kubernetes,k8s # remove k8s when v9 is released
      mondoo.com/category: best-practices
    filters:
      - asset.platform == "k8s-job"
    queries:
      - uid: k8s-job
        title: Gather Job Information
        query: |
          k8s.job { * }
      - uid: k8s-job-container
        title: Gather Container Information
        query: |
          k8s.job.containers { * }
  - uid: mondoo-kubernetes-daemonsets-inventory
    name: Kubernetes DaemonSets Inventory Pack by Mondoo
    version: 1.1.0
    tags:
      mondoo.com/platform: kubernetes,k8s # remove k8s when v9 is released
      mondoo.com/category: best-practices
    filters:
      - asset.platform == "k8s-daemonset"
    queries:
      - uid: k8s-daemonset
        title: Gather DaemonSet Information
        query: |
          k8s.daemonset { * }
      - uid: k8s-daemonset-container
        title: Gather Container Information
        query: |
          k8s.daemonset.containers { * }
  - uid: mondoo-kubernetes-statefulsets-inventory
    name: Kubernetes StatefulSets Inventory Pack by Mondoo
    version: 1.1.0
    tags:
      mondoo.com/platform: kubernetes,k8s # remove k8s when v9 is released
      mondoo.com/category: best-practices
    filters:
      - asset.platform == "k8s-statefulset"
    queries:
      - uid: k8s-statefulset
        title: Gather StatefulSet Information
        query: |
          k8s.statefulset { * }
      - uid: k8s-statefulset-container
        title: Gather Container Information
        query: |
          k8s.statefulset.containers { * }
  - uid: mondoo-kubernetes-replicasets-inventory
    name: Kubernetes ReplicaSets Inventory Pack by Mondoo
    version: 1.1.0
    tags:
      mondoo.com/platform: kubernetes,k8s # remove k8s when v9 is released
      mondoo.com/category: best-practices
    filters:
      - asset.platform == "k8s-replicaset"
    queries:
      - uid: k8s-replicaset
        title: Gather ReplicaSet Information
        query: |
          k8s.replicaset { * }
      - uid: k8s-replicaset-container
        title: Gather Container Information
        query: |
          k8s.replicaset.containers { * }


