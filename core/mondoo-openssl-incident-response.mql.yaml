# Copyright (c) Mondoo, Inc.
# SPDX-License-Identifier: BUSL-1.1

packs:
  - uid: mondoo-openssl-incident-response
    name: OpenSSL Incident Response Pack
    version: 1.1.0
    license: BUSL-1.1
    authors:
      - name: Mondoo, Inc
        email: hello@mondoo.com
    tags:
      mondoo.com/platform: linux,host
      mondoo.com/category: best-practices
    filters:
      - asset.family.contains("linux")
    queries:
      - uid: mondoo-openssl-incident-response-platform
        title: Retrieve platform details
        mql: |
          asset {
            platform
            version
            arch
          }
      - uid: mondoo-openssl-incident-response-installed-version
        title: Retrieve installed ssl libraries
        mql: packages.where(name == /ssl/)
      - uid: mondoo-openssl-incident-response-listening-ports
        title: Retrieve listening ports from running systems
        mql: |
          if ( mondoo.capabilities.contains('run-command') ) {
            ports.listening { 
              protocol
              address
              port
            }
          }
