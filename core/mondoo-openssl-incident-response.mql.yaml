packs:
  - uid: mondoo-openssl-incident-response
    name: OpenSSL Incident Response Pack
    version: 1.0.0
    authors:
      - name: Mondoo, Inc
        email: hello@mondoo.com
    tags:
      mondoo.com/platform: linux,host
      mondoo.com/category: best-practices
    filters:
      - asset.family.contains("linux")
    queries:
      - uid: mondoo-openssl-platform
        title: Retrieve platform details
        query: |
          asset {
            platform
            version
            arch
          }
      - uid: mondoo-openssl-installed-version
        title: Retrieve installed ssl libraries
        query: packages.where(name == /ssl/)
      - uid: mondoo-openssl-listening-ports
        title: Retrieve listening ports from running systems
        query: |
          if ( mondoo.capabilities.contains('run-command') ) {
            ports.listening { 
              protocol
              address
              port
            }
          }