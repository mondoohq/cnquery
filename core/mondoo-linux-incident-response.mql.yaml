# Copyright (c) Mondoo, Inc.
# SPDX-License-Identifier: BUSL-1.1

packs:
  - uid: mondoo-linux-incident-response
    name: Linux Incident Response Pack
    version: 1.1.0
    license: BUSL-1.1
    authors:
      - name: Mondoo, Inc
        email: hello@mondoo.com
    tags:
      mondoo.com/platform: linux,host
      mondoo.com/category: security
    filters:
      - asset.family.contains("linux")
    queries:
      - uid: mondoo-linux-incident-response-installed-kernel
        title: Retrieve installed Linux kernels
        mql: |
          if ( mondoo.capabilities.contains('run-command') ) {
            kernel.installed
          }
      - uid: mondoo-linux-incident-response-kernel-info
        title: Retrieve the running Linux kernel
        mql: |
          if ( mondoo.capabilities.contains('run-command') ) {
            kernel.info
          }
      - uid: mondoo-linux-incident-response-kernel-modules
        title: Retrieve Linux kernel modules
        mql: kernel.modules { name loaded }
      - uid: mondoo-linux-incident-response-processes
        title: Retrieve running processes
        mql: |
          if ( mondoo.capabilities.contains('run-command') ) {
            processes { pid  command }
          }
      - uid: mondoo-linux-incident-response-mounts
        title: Retrieve mounted devices
        mql: mount.list { * } 
      - uid: mondoo-linux-incident-response-listening-ports
        title: Retrieve all listening ports
        mql: |
          if ( mondoo.capabilities.contains('run-command') ) {
            ports.listening { * }
          }
      - uid: mondoo-linux-incident-response-uptime
        title: Retrieve operating system uptime
        mql: |
          if ( mondoo.capabilities.contains('run-command') ) {
            os.uptime
          }
      - uid: mondoo-linux-incident-response-installed-packages
        title: Retrieve installed packages
        mql: packages { * }
      - uid: mondoo-linux-incident-response-running-services
        title: Retrieve running services
        mql: services { * }
