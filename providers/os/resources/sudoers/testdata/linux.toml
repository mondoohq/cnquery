# Test data for sudoers parsing

[files."/etc/sudoers"]
content = """# /etc/sudoers
#
# This file MUST be edited with the 'visudo' command as root.
#
# See the man page for details on how to write a sudoers file.
#

# Defaults specification
Defaults env_reset
Defaults mail_badpass
Defaults secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
Defaults:root !requiretty
Defaults@webservers log_output

# Host alias specification
Host_Alias WEBSERVERS = www1, www2, www3
Host_Alias DBSERVERS = db1, db2

# User alias specification
User_Alias ADMINS = alice, bob, charlie
User_Alias OPERATORS = dave, eve

# Cmnd alias specification
Cmnd_Alias SHUTDOWN = /sbin/halt, /sbin/shutdown, /sbin/reboot
Cmnd_Alias SERVICES = /usr/bin/systemctl restart *, /usr/bin/systemctl stop *

# Runas alias specification
Runas_Alias DBA = postgres, mysql

# User privilege specification
root ALL=(ALL:ALL) ALL

# Members of the admin group may gain root privileges
%admin ALL=(ALL) ALL

# Allow members of group sudo to execute any command
%sudo ALL=(ALL:ALL) ALL

# ADMINS can run shutdown commands without password
ADMINS ALL=(ALL) NOPASSWD: SHUTDOWN

# Operators can manage services
OPERATORS WEBSERVERS=(root) SERVICES

# User dave can run commands as DBA users
dave ALL=(DBA) /usr/bin/psql, /usr/bin/mysql

# Include drop-in directory
@includedir /etc/sudoers.d
"""

[files."/etc/sudoers.d"]
stat.isdir = true
content = """10-developers
99-monitoring
"""

[files."/etc/sudoers.d/10-developers"]
content = """# Developer access rules
%developers ALL=(ALL) NOPASSWD: /usr/bin/docker, /usr/bin/docker-compose
developer1 ALL=(www-data) NOPASSWD: ALL
"""

[files."/etc/sudoers.d/99-monitoring"]
content = """# Monitoring access
nagios ALL=(root) NOPASSWD: /usr/lib/nagios/plugins/*, /usr/bin/systemctl status *
zabbix ALL=(root) NOPASSWD: /usr/sbin/dmidecode, /usr/bin/lsof
"""
