# Copyright (c) Mondoo, Inc.
# SPDX-License-Identifier: BUSL-1.1

resources:
  microsoft:
    fields:
      applications: {}
      domains: {}
      enterpriseApplications:
        min_mondoo_version: latest
      groups: {}
      organizations: {}
      roles:
        min_mondoo_version: 9.0.0
      serviceprincipals: {}
      settings: {}
      tenantDomainName:
        min_mondoo_version: latest
      users: {}
    min_mondoo_version: 5.15.0
  microsoft.adminPortal:
    fields:
      delegatedAdminPartners: {}
    min_mondoo_version: 9.0.0
  microsoft.adminPortal.delegatedAdminPartner:
    fields:
      displayName: {}
      id: {}
    min_mondoo_version: 9.0.0
  microsoft.application:
    fields:
      api:
        min_mondoo_version: 9.0.0
      appId: {}
      appRoles:
        min_mondoo_version: 9.0.0
      applicationTemplateId:
        min_mondoo_version: 9.0.0
      certificates:
        min_mondoo_version: 9.0.0
      certification:
        min_mondoo_version: 9.0.0
      createdAt:
        min_mondoo_version: 9.0.0
      createdDateTime: {}
      defaultRedirectUri:
        min_mondoo_version: 9.0.0
      description:
        min_mondoo_version: 9.0.0
      dict:
        min_mondoo_version: 9.0.0
      disabledByMicrosoftStatus:
        min_mondoo_version: 9.0.0
      displayName: {}
      groupMembershipClaims:
        min_mondoo_version: 9.0.0
      hasExpiredCredentials:
        min_mondoo_version: 9.0.0
      id: {}
      identifierUris: {}
      info:
        min_mondoo_version: 9.0.0
      isDeviceOnlyAuthSupported:
        min_mondoo_version: 9.0.0
      isFallbackPublicClient:
        min_mondoo_version: 9.0.0
      name:
        min_mondoo_version: 9.0.0
      nativeAuthenticationApisEnabled:
        min_mondoo_version: 9.0.0
      notes:
        min_mondoo_version: 9.0.0
      optionalClaims:
        min_mondoo_version: 9.0.0
      owners:
        min_mondoo_version: 9.0.0
      parentalControlSettings:
        min_mondoo_version: 9.0.0
      publicClient:
        min_mondoo_version: 9.0.0
      publisherDomain: {}
      requestSignatureVerification:
        min_mondoo_version: 9.0.0
      requiredResourceAccess:
        min_mondoo_version: 9.0.0
      samlMetadataUrl:
        min_mondoo_version: 9.0.0
      secrets:
        min_mondoo_version: 9.0.0
      serviceManagementReference:
        min_mondoo_version: 9.0.0
      servicePrincipal:
        min_mondoo_version: 9.0.0
      servicePrincipalLockConfiguration:
        min_mondoo_version: 9.0.0
      signInAudience: {}
      spa:
        min_mondoo_version: 9.0.0
      string:
        min_mondoo_version: 9.0.0
      tags:
        min_mondoo_version: 9.0.0
      tokenEncryptionKeyId:
        min_mondoo_version: 9.0.0
      web:
        min_mondoo_version: 9.0.0
    min_mondoo_version: 5.15.0
  microsoft.application.permission:
    fields:
      adminConsent: {}
      appId: {}
      appName: {}
      description: {}
      id: {}
      name: {}
      status: {}
      type: {}
    is_private: true
    min_mondoo_version: 9.0.0
  microsoft.application.role:
    fields:
      allowedMemberTypes: {}
      description: {}
      id: {}
      isEnabled: {}
      name: {}
      value: {}
    is_private: true
    min_mondoo_version: 9.0.0
  microsoft.devicemanagement:
    fields:
      deviceCompliancePolicies: {}
      deviceConfigurations: {}
    min_mondoo_version: 5.15.0
  microsoft.devicemanagement.devicecompliancepolicy:
    fields:
      assignments: {}
      createdDateTime: {}
      description: {}
      displayName: {}
      id: {}
      lastModifiedDateTime: {}
      properties: {}
      version: {}
    is_private: true
    min_mondoo_version: 5.15.0
  microsoft.devicemanagement.deviceconfiguration:
    fields:
      createdDateTime: {}
      description: {}
      displayName: {}
      id: {}
      lastModifiedDateTime: {}
      properties: {}
      version: {}
    is_private: true
    min_mondoo_version: 5.15.0
  microsoft.domain:
    fields:
      authenticationType: {}
      availabilityStatus: {}
      id: {}
      isAdminManaged: {}
      isDefault: {}
      isInitial: {}
      isRoot: {}
      isVerified: {}
      passwordNotificationWindowInDays: {}
      passwordValidityPeriodInDays: {}
      serviceConfigurationRecords: {}
      supportedServices: {}
    is_private: true
    min_mondoo_version: 5.15.0
  microsoft.domaindnsrecord:
    fields:
      id: {}
      isOptional: {}
      label: {}
      properties: {}
      recordType: {}
      supportedService: {}
      ttl: {}
    is_private: true
    min_mondoo_version: 5.15.0
  microsoft.enterpriseApplication:
    fields:
      id: {}
      name: {}
      tags: {}
      type: {}
    min_mondoo_version: latest
  microsoft.group:
    fields:
      displayName: {}
      groupTypes:
        min_mondoo_version: 9.0.0
      id: {}
      mail: {}
      mailEnabled: {}
      mailNickname: {}
      members: {}
      membershipRule:
        min_mondoo_version: 9.0.0
      membershipRuleProcessingState:
        min_mondoo_version: 9.0.0
      securityEnabled: {}
      visibility:
        min_mondoo_version: 9.0.0
    is_private: true
    min_mondoo_version: 5.15.0
  microsoft.keyCredential:
    fields:
      description: {}
      displayName: {}
      expired: {}
      expires: {}
      hint: {}
      keyId: {}
      thumbprint: {}
      type: {}
      usage: {}
    is_private: true
    min_mondoo_version: 9.0.0
  microsoft.organization:
    fields:
      assignedPlans: {}
      createdDateTime: {}
      displayName: {}
      id: {}
      onPremisesSyncEnabled:
        min_mondoo_version: 9.0.0
      verifiedDomains: {}
    min_mondoo_version: 5.15.0
  microsoft.passwordCredential:
    fields:
      description: {}
      displayName: {}
      expired: {}
      expires: {}
      hint: {}
      keyId: {}
    is_private: true
    min_mondoo_version: 9.0.0
  microsoft.policies:
    fields:
      adminConsentRequestPolicy: {}
      authorizationPolicy: {}
      identitySecurityDefaultsEnforcementPolicy: {}
      permissionGrantPolicies: {}
    min_mondoo_version: 5.15.0
  microsoft.rolemanagement:
    fields:
      roleDefinitions: {}
    min_mondoo_version: 5.15.0
  microsoft.rolemanagement.roleassignment:
    fields:
      id: {}
      principal: {}
      principalId: {}
      roleDefinitionId: {}
    is_private: true
    min_mondoo_version: 5.15.0
  microsoft.rolemanagement.roledefinition:
    fields:
      assignments: {}
      description: {}
      displayName: {}
      id: {}
      isBuiltIn: {}
      isEnabled: {}
      rolePermissions: {}
      templateId: {}
      version: {}
    is_private: true
    min_mondoo_version: 5.15.0
  microsoft.security:
    fields:
      latestSecureScores: {}
      riskyUsers:
        min_mondoo_version: 9.0.0
      secureScores: {}
    min_mondoo_version: 5.15.0
  microsoft.security.riskyUser:
    fields:
      id: {}
      lastUpdatedAt: {}
      name: {}
      principalName: {}
      riskDetail: {}
      riskLevel: {}
      riskState: {}
      user: {}
    min_mondoo_version: 9.0.0
  microsoft.security.securityscore:
    fields:
      activeUserCount: {}
      averageComparativeScores: {}
      azureTenantId: {}
      controlScores: {}
      createdDateTime: {}
      currentScore: {}
      enabledServices: {}
      id: {}
      licensedUserCount: {}
      maxScore: {}
      vendorInformation: {}
    is_private: true
    min_mondoo_version: 5.15.0
  microsoft.serviceprincipal:
    fields:
      accountEnabled:
        min_mondoo_version: 9.0.0
      appId:
        min_mondoo_version: 9.0.0
      appOwnerOrganizationId:
        min_mondoo_version: 9.0.0
      appRoleAssignmentRequired:
        min_mondoo_version: 9.0.0
      appRoleAssignments:
        min_mondoo_version: latest
      appRoles:
        min_mondoo_version: 9.0.0
      applicationTemplateId:
        min_mondoo_version: 9.0.0
      assignmentRequired:
        min_mondoo_version: latest
      assignments:
        min_mondoo_version: latest
      description:
        min_mondoo_version: 9.0.0
      enabled:
        min_mondoo_version: latest
      homepageUrl:
        min_mondoo_version: latest
      id: {}
      isFirstParty:
        min_mondoo_version: 9.0.0
      loginUrl:
        min_mondoo_version: 9.0.0
      logoutUrl:
        min_mondoo_version: 9.0.0
      name:
        min_mondoo_version: latest
      notes:
        min_mondoo_version: latest
      notificationEmailAddresses:
        min_mondoo_version: 9.0.0
      permissions:
        min_mondoo_version: 9.0.0
      preferredSingleSignOnMode:
        min_mondoo_version: 9.0.0
      properties:
        min_mondoo_version: latest
      replyUrls:
        min_mondoo_version: latest
      servicePrincipalNames:
        min_mondoo_version: 9.0.0
      signInAudience:
        min_mondoo_version: 9.0.0
      tags:
        min_mondoo_version: latest
      termsOfServiceUrl:
        min_mondoo_version: latest
      type:
        min_mondoo_version: latest
      userAccessUrl:
        min_mondoo_version: latest
      verifiedPublisher:
        min_mondoo_version: 9.0.0
      visibleToUsers:
        min_mondoo_version: latest
    min_mondoo_version: 5.15.0
  microsoft.serviceprincipal.appRoleAssignment:
    fields:
      displayName: {}
      id: {}
      type: {}
    min_mondoo_version: latest
  microsoft.serviceprincipal.assignment:
    fields:
      appId: {}
      displayName: {}
      id: {}
      resourceName: {}
      type: {}
    is_private: true
    min_mondoo_version: latest
  microsoft.tenant:
    fields:
      assignedPlans: {}
      createdAt: {}
      createdDateTime: {}
      displayName: {}
      id: {}
      name: {}
      onPremisesSyncEnabled: {}
      provisionedPlans: {}
      subscription: {}
      subscriptions: {}
      type: {}
      verifiedDomains: {}
    min_mondoo_version: 9.0.0
  microsoft.user:
    fields:
      accountEnabled: {}
      authMethods:
        min_mondoo_version: 9.0.0
      city: {}
      companyName: {}
      contact:
        min_mondoo_version: 9.0.0
      country: {}
      createdDateTime: {}
      department: {}
      displayName: {}
      employeeId: {}
      givenName: {}
      id: {}
      job:
        min_mondoo_version: 9.0.0
      jobTitle: {}
      mail: {}
      mobilePhone: {}
      officeLocation: {}
      otherMails: {}
      postalCode: {}
      settings: {}
      state: {}
      streetAddress: {}
      surname: {}
      userPrincipalName: {}
      userType: {}
    is_private: true
    min_mondoo_version: 5.15.0
  microsoft.user.authenticationMethods:
    fields:
      count: {}
      emailMethods: {}
      fido2Methods: {}
      microsoftAuthenticator: {}
      passwordMethods: {}
      phoneMethods: {}
      softwareMethods: {}
      temporaryAccessPassMethods: {}
      windowsHelloMethods: {}
    is_private: true
    min_mondoo_version: 9.0.0
  ms365.exchangeonline:
    fields:
      adminAuditLogConfig: {}
      antiPhishPolicy: {}
      atpPolicyForO365: {}
      authenticationPolicy: {}
      dkimSigningConfig: {}
      externalInOutlook: {}
      hostedOutboundSpamFilterPolicy: {}
      mailbox: {}
      malwareFilterPolicy: {}
      organizationConfig: {}
      owaMailboxPolicy: {}
      phishFilterPolicy: {}
      remoteDomain: {}
      reportSubmissionPolicies:
        min_mondoo_version: 9.0.0
      roleAssignmentPolicy: {}
      safeAttachmentPolicy: {}
      safeLinksPolicy: {}
      sharedMailboxes:
        min_mondoo_version: 9.2.13
      sharingPolicy: {}
      teamsProtectionPolicies:
        min_mondoo_version: latest
      teamsProtectionPolicy:
        min_mondoo_version: latest
      transportRule: {}
    min_mondoo_version: 5.15.0
    platform:
      name:
      - microsoft365
  ms365.exchangeonline.exoMailbox:
    fields:
      externalDirectoryObjectId: {}
      identity: {}
      user: {}
    is_private: true
    min_mondoo_version: 9.2.13
    platform:
      name:
      - microsoft365
  ms365.exchangeonline.externalSender:
    fields:
      allowList: {}
      enabled: {}
      identity: {}
    is_private: true
    min_mondoo_version: latest
    platform:
      name:
      - microsoft365
  ms365.exchangeonline.reportSubmissionPolicy:
    fields:
      reportChatMessageEnabled: {}
      reportChatMessageToCustomizedAddressEnabled: {}
      reportJunkAddresses: {}
      reportJunkToCustomizedAddress: {}
      reportNotJunkAddresses: {}
      reportNotJunkToCustomizedAddress: {}
      reportPhishAddresses: {}
      reportPhishToCustomizedAddress: {}
    is_private: true
    min_mondoo_version: latest
    platform:
      name:
      - microsoft365
  ms365.exchangeonline.teamsProtectionPolicy:
    fields:
      isValid: {}
      zapEnabled: {}
    is_private: true
    min_mondoo_version: 9.0.0
    platform:
      name:
      - microsoft365
  ms365.sharepointonline:
    fields:
      spoSites:
        min_mondoo_version: 9.0.0
      spoTenant: {}
      spoTenantSyncClientRestriction: {}
    min_mondoo_version: 5.15.0
    platform:
      name:
      - microsoft365
  ms365.sharepointonline.site:
    fields:
      denyAddAndCustomizePages: {}
      url: {}
    is_private: true
    min_mondoo_version: 9.0.0
    platform:
      name:
      - microsoft365
  ms365.teams:
    fields:
      csTeamsClientConfiguration: {}
      csTeamsMeetingPolicy:
        min_mondoo_version: 9.0.0
      csTeamsMessagingPolicy:
        min_mondoo_version: 9.0.0
      csTenantFederationConfiguration:
        min_mondoo_version: 9.0.0
    min_mondoo_version: 5.15.0
    platform:
      name:
      - microsoft365
  ms365.teams.teamsMeetingPolicyConfig:
    fields:
      allowAnonymousUsersToJoinMeeting: {}
      allowAnonymousUsersToStartMeeting: {}
      allowExternalNonTrustedMeetingChat: {}
      allowExternalParticipantGiveRequestControl: {}
      allowPSTNUsersToBypassLobby: {}
      allowSecurityEndUserReporting: {}
      autoAdmittedUsers: {}
      designatedPresenterRoleMode: {}
      meetingChatEnabledType: {}
    is_private: true
    min_mondoo_version: latest
    platform:
      name:
      - microsoft365
  ms365.teams.teamsMessagingPolicyConfig:
    fields:
      allowSecurityEndUserReporting: {}
    is_private: true
    min_mondoo_version: 9.0.0
    platform:
      name:
      - microsoft365
  ms365.teams.tenantFederationConfig:
    fields:
      allowFederatedUsers: {}
      allowPublicUsers: {}
      allowTeamsConsumer: {}
      allowTeamsConsumerInbound: {}
      allowedDomains: {}
      blockedDomains: {}
      identity: {}
      restrictTeamsConsumerToExternalUserProfiles: {}
      sestrictTeamsConsumerToExternalUserProfiles: {}
      sharedSipAddressSpace: {}
      treatDiscoveredPartnersAsUnverified: {}
    is_private: true
    min_mondoo_version: 9.0.0
    platform:
      name:
      - microsoft365
