# Copyright (c) Mondoo, Inc.
# SPDX-License-Identifier: BUSL-1.1

packs:
  - uid: mondoo-windows-incident-response
    name: Windows Incident Response Pack
    version: 1.2.0
    license: BUSL-1.1
    authors:
      - name: Mondoo, Inc
        email: hello@mondoo.com
    tags:
      mondoo.com/platform: windows
      mondoo.com/category: security
    docs:
      desc: |
        ### Overview

        The Windows Incident Response Pack retrieves configuration data from Windows hosts for investigation during a security incident. This includes installed hotfixes, system uptime, installed packages, computer information, and running services.

        ### Run query pack

        To run this query pack locally on a Windows host:

        ```bash
        cnquery scan local -f mondoo-windows-incident-response.mql.yaml
        ```

        To run against a remote Windows host using SSH:

        ```bash
        cnquery scan ssh <user>@<ip_address> -f mondoo-windows-incident-response.mql.yaml
        ```

        To run against a remote Windows host using WinRM:

        ```bash
        cnquery scan winrm <user>@<ip_address> -f mondoo-windows-incident-response.mql.yaml
        ```
    filters:
      - asset.platform == "windows"
    queries:
      - uid: mondoo-windows-incident-response-installed-hotfixes
        title: Installed hotfixes
        docs:
          desc: Lists all installed Windows hotfixes with their ID and installation date to verify patch status and identify missing security updates.
        mql: windows.hotfixes { hotfixId installedOn }
      - uid: mondoo-windows-incident-response-uptime
        title: Operating system uptime
        docs:
          desc: Returns the system uptime to help determine when the system was last rebooted and establish incident timeline.
        mql: os.uptime
      - uid: mondoo-windows-incident-response-installed-packages
        title: Installed packages
        docs:
          desc: Lists all installed software packages to identify potentially malicious or vulnerable applications.
        mql: packages
      - uid: mondoo-windows-incident-response-interface-configuration
        title: Windows Computer/System information
        docs:
          desc: Retrieves detailed Windows system information including hardware and OS configuration for asset identification.
        mql: windows.computerInfo
      - uid: mondoo-windows-incident-response-running-services
        title: Running services
        docs:
          desc: Lists all currently running Windows services to identify suspicious or unauthorized services that may indicate compromise.
        mql: services.where(running == true)
