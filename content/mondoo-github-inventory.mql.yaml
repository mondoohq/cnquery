# Copyright (c) Mondoo, Inc.
# SPDX-License-Identifier: BUSL-1.1

packs:
  - uid: mondoo-github-inventory-org
    name: GitHub Organization Inventory Pack
    version: 1.1.0
    license: BUSL-1.1
    authors:
      - name: Mondoo, Inc
        email: hello@mondoo.com
    tags:
      mondoo.com/platform: github,saas
      mondoo.com/category: best-practices
    docs:
      desc: |
        ### Overview

        The GitHub Organization Inventory Pack by Mondoo query pack retrieves configuration data about GitHub organizations.

        ### Prerequisites

        To run this query pack, you will need a [GitHub personal access token](https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token) with read access to the GitHub organization you are scanning.

        ### Run query pack

        To run this query pack against a GitHub organization:

        ```bash
        export GITHUB_TOKEN=<your personal access token>
        cnquery scan github org <org_name> -f mondoo-github-inventory.mq.yaml
        ```
    filters:
      - asset.platform == "github-org"
    queries:
      - uid: mondoo-github-inventory-org-login
        title: GitHub organization login
        docs:
          desc: Returns the login handle (URL slug) of the GitHub organization.
        mql: github.organization.login
      - uid: mondoo-github-inventory-org-id
        title: GitHub organization ID
        docs:
          desc: Returns the unique numeric identifier of the GitHub organization.
        mql: github.organization.id
      - uid: mondoo-github-inventory-org-profile-photo
        title: GitHub organization profile photo
        docs:
          desc: Returns the URL of the organization's avatar/profile photo.
        mql: github.organization.avatarUrl
      - uid: mondoo-github-inventory-org-email
        title: GitHub organization email
        docs:
          desc: Returns the public email address configured for the organization.
        mql: github.organization.email
      - uid: mondoo-github-inventory-org-desc
        title: GitHub organization description
        docs:
          desc: Returns the description configured for the GitHub organization.
        mql: github.organization.description
      - uid: mondoo-github-inventory-org-blog
        title: GitHub organization blog
        docs:
          desc: Returns the blog/website URL configured for the organization.
        mql: github.organization.blog
      - uid: mondoo-github-inventory-org-location
        title: GitHub organization location
        docs:
          desc: Returns the location configured for the organization profile.
        mql: github.organization.location
      - uid: mondoo-github-inventory-org-followers
        title: GitHub organization followers
        docs:
          desc: Returns the number of users following the organization.
        mql: github.organization.followers
      - uid: mondoo-github-inventory-org-following
        title: GitHub organization following
        docs:
          desc: Returns the number of users the organization is following.
        mql: github.organization.following
      - uid: mondoo-github-inventory-org-twitter
        title: GitHub organization twitter handle
        docs:
          desc: Returns the Twitter/X username configured for the organization.
        mql: github.organization.twitterUsername
      - uid: mondoo-github-inventory-org-number-repositories
        title: GitHub organization repositories
        docs:
          desc: Returns the total number of repositories in the organization.
        mql: github.organization.repositories.length
      - uid: mondoo-github-inventory-org-created
        title: GitHub organization created
        docs:
          desc: Returns the timestamp when the organization was created.
        mql: github.organization.createdAt
      - uid: mondoo-github-inventory-org-updated
        title: GitHub organization updated
        docs:
          desc: Returns the timestamp when the organization was last updated.
        mql: github.organization.updatedAt
  - uid: mondoo-github-inventory-user
    name: GitHub User Inventory Pack
    version: 1.0.0
    authors:
      - name: Mondoo, Inc
        email: hello@mondoo.com
    tags:
      mondoo.com/platform: github,saas
      mondoo.com/category: best-practices
    docs:
      desc: |
        ### Overview

        The Mondoo GitHub User Inventory query pack retrieves configuration data about GitHub users.

        ### Prerequisites

        To run this query pack, you will need a [GitHub personal access token](https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token) with read access to the GitHub organization you are scanning.

        ### Run query pack

        To run this query pack against a GitHub user:

        ```bash
        export GITHUB_TOKEN=<your personal access token>
        cnquery scan github user <user_name> -f mondoo-github-inventory.mq.yaml
        ```
    filters:
      - asset.platform == "github-user"
    queries:
      - uid: mondoo-github-inventory-user-login
        title: GitHub user login
        docs:
          desc: Returns the login/username of the GitHub user.
        mql: github.user.login
      - uid: mondoo-github-inventory-user-id
        title: GitHub user ID
        docs:
          desc: Returns the unique numeric identifier of the GitHub user.
        mql: github.user.id
      - uid: mondoo-github-inventory-user-profile-photo
        title: GitHub user profile photo
        docs:
          desc: Returns the URL of the user's avatar/profile photo.
        mql: github.user.avatarUrl
      - uid: mondoo-github-inventory-user-email
        title: GitHub user email
        docs:
          desc: Returns the public email address of the GitHub user.
        mql: github.user.email
      - uid: mondoo-github-inventory-user-bio
        title: GitHub user bio
        docs:
          desc: Returns the biography text from the user's profile.
        mql: github.user.bio
      - uid: mondoo-github-inventory-user-blog
        title: GitHub user blog
        docs:
          desc: Returns the blog/website URL from the user's profile.
        mql: github.user.blog
      - uid: mondoo-github-inventory-user-location
        title: GitHub user location
        docs:
          desc: Returns the location from the user's profile.
        mql: github.user.location
      - uid: mondoo-github-inventory-user-followers
        title: GitHub user followers
        docs:
          desc: Returns the number of users following this user.
        mql: github.user.followers
      - uid: mondoo-github-inventory-user-following
        title: GitHub user following
        docs:
          desc: Returns the number of users this user is following.
        mql: github.user.following
      - uid: mondoo-github-inventory-user-twitter
        title: GitHub user twitter handle
        docs:
          desc: Returns the Twitter/X username from the user's profile.
        mql: github.user.twitterUsername
      - uid: mondoo-github-inventory-user-number-repositories
        title: GitHub user repositories
        docs:
          desc: Returns the total number of repositories owned by the user.
        mql: github.user.repositories.length
      - uid: mondoo-github-inventory-user-created
        title: GitHub user created
        docs:
          desc: Returns the timestamp when the user account was created.
        mql: github.user.createdAt
      - uid: mondoo-github-inventory-user-updated
        title: GitHub user updated
        docs:
          desc: Returns the timestamp when the user profile was last updated.
        mql: github.user.updatedAt
  - uid: mondoo-github-inventory-repo
    name: GitHub Repository Inventory Pack
    version: 1.0.0
    authors:
      - name: Mondoo, Inc
        email: hello@mondoo.com
    tags:
      mondoo.com/platform: github,saas
      mondoo.com/category: best-practices
    docs:
      desc: |
        ### Overview

        The Mondoo GitHub Repository Inventory query pack retrieves configuration data about GitHub repositories.

        ### Prerequisites

        To run this query pack, you will need a [GitHub personal access token](https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token) with read access to the GitHub organization you are scanning.

        ### Run query pack

        To run this query pack against a GitHub repository:

        ```bash
        export GITHUB_TOKEN=<your personal access token>
        cnquery scan github repo <owner>/<repo> -f mondoo-github-inventory.mq.yaml
        ```
    filters:
      - asset.platform == "github-repo"
    queries:
      - uid: mondoo-github-inventory-repo-id
        title: GitHub repository ID
        docs:
          desc: Returns the unique numeric identifier of the repository.
        mql: github.repository.id
      - uid: mondoo-github-inventory-repo-description
        title: GitHub repository description
        docs:
          desc: Returns the description text of the repository.
        mql: github.repository.description
      - uid: mondoo-github-inventory-repo-forks
        title: Number GitHub repository forks
        docs:
          desc: Returns the number of times this repository has been forked.
        mql: github.repository.forksCount
      - uid: mondoo-github-inventory-repo-stargazers
        title: Number GitHub repository stargazers
        docs:
          desc: Returns the number of users who have starred the repository.
        mql: github.repository.stargazersCount
      - uid: mondoo-github-inventory-repo-watchers
        title: Number GitHub repository watchers
        docs:
          desc: Returns the number of users watching the repository for notifications.
        mql: github.repository.watchersCount
      - uid: mondoo-github-inventory-repo-license
        title: GitHub repository license
        docs:
          desc: Returns the SPDX identifier of the repository's license.
        mql: github.repository.license.spdxId
      - uid: mondoo-github-inventory-repo-default-branch
        title: GitHub repo default branch
        docs:
          desc: Returns the name of the repository's default branch.
        mql: github.repository.defaultBranchName
      - uid: mondoo-github-inventory-repo-visibility
        title: GitHub repository visibility
        docs:
          desc: Returns the visibility setting (public, private, internal) of the repository.
        mql: github.repository.visibility
      - uid: mondoo-github-inventory-repo-languages
        title: GitHub repository languages
        docs:
          desc: Returns the primary programming language of the repository.
        mql: github.repository.language
      - uid: mondoo-github-inventory-repo-open-issues
        title: GitHub repository open issues
        docs:
          desc: Returns the count of open issues and pull requests in the repository.
        mql: github.repository.openIssuesCount
      - uid: mondoo-github-inventory-repo-topics
        title: GitHub repository topics
        docs:
          desc: Returns the topic tags assigned to the repository.
        mql: github.repository.topics
      - uid: mondoo-github-inventory-repo-homepage
        title: GitHub repository homepage
        docs:
          desc: Returns the homepage URL configured for the repository.
        mql: github.repository.homepage
      - uid: mondoo-github-inventory-repo-clone-url
        title: GitHub repository Clone URL
        docs:
          desc: Returns the HTTPS URL for cloning the repository.
        mql: github.repository.cloneUrl
      - uid: mondoo-github-inventory-repo-ssl-url
        title: GitHub repository SSH URL
        docs:
          desc: Returns the SSH URL for cloning the repository.
        mql: github.repository.sshUrl
      - uid: mondoo-github-inventory-repo-is-fork
        title: Is fork
        docs:
          desc: Returns whether the repository is a fork of another repository.
        mql: github.repository.isFork
      - uid: mondoo-github-inventory-repo-is-forkable
        title: Is forkable
        docs:
          desc: Returns whether forking is allowed for the repository.
        mql: github.repository.allowForking
      - uid: mondoo-github-inventory-repo-is-private
        title: Is private
        docs:
          desc: Returns whether the repository is private.
        mql: github.repository.private
      - uid: mondoo-github-inventory-repo-is-archived
        title: Is archived
        docs:
          desc: Returns whether the repository has been archived.
        mql: github.repository.archived
      - uid: mondoo-github-inventory-repo-has-downloads
        title: Has downloads
        docs:
          desc: Returns whether downloads are enabled for the repository.
        mql: github.repository.hasDownloads
      - uid: mondoo-github-inventory-repo-has-issues
        title: Has issues
        docs:
          desc: Returns whether the issues feature is enabled for the repository.
        mql: github.repository.hasIssues
      - uid: mondoo-github-inventory-repo-has-pages
        title: Has pages
        docs:
          desc: Returns whether GitHub Pages is enabled for the repository.
        mql: github.repository.hasPages
      - uid: mondoo-github-inventory-repo-has-projects
        title: Has projects
        docs:
          desc: Returns whether projects feature is enabled for the repository.
        mql: github.repository.hasProjects
      - uid: mondoo-github-inventory-repo-has-wiki
        title: Has wiki
        docs:
          desc: Returns whether the wiki feature is enabled for the repository.
        mql: github.repository.hasWiki
      - uid: mondoo-github-inventory-repo-pushed-at
        title: Pushed at
        docs:
          desc: Returns the timestamp of the last push to the repository.
        mql: github.repository.pushedAt
      - uid: mondoo-github-inventory-repo-created-at
        title: Created at
        docs:
          desc: Returns the timestamp when the repository was created.
        mql: github.repository.createdAt
      - uid: mondoo-github-inventory-repo-updated-at
        title: Updated at
        docs:
          desc: Returns the timestamp when the repository was last updated.
        mql: github.repository.updatedAt
