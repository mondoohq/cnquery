# Copyright (c) Mondoo, Inc.
# SPDX-License-Identifier: BUSL-1.1

packs:
  - uid: mondoo-shodan-inventory
    name: Shodan Inventory Pack
    version: 1.1.0
    license: BUSL-1.1
    authors:
      - name: Mondoo, Inc
        email: hello@mondoo.com
    tags:
      mondoo.com/platform: shodan
      mondoo.com/category: best-practices
    docs:
      desc: |
        The Shodan Inventory Pack by Mondoo retrieves data about shodan.io assets. 

        ## Local scan
        To run this pack locally:

        ```bash
        export SHODAN_TOKEN="XXX"
        cnquery scan shodan --networks "1.1.1.1/28" --discover hosts -f mondoo-shodan-inventory.mql.yaml
        ```

        ## Join the community!
        Our goal is to build query packs that are simple to deploy and provide accurate and useful data. 

        If you have any suggestions for improving this query pack, or if you need support, [join the Mondoo community](https://github.com/orgs/mondoohq/discussions) in GitHub Discussions.
    filters: asset.family.contains("shodan")
    queries:
      - uid: mondoo-shodan-inventory-hostnames
        title: Shodan info about Hostnames / DNS
        docs:
          desc: Returns hostnames associated with the IP address from Shodan's database.
        filters: asset.platform == "shodan-host"
        mql: |
          shodan.host.hostnames
      - uid: mondoo-shodan-inventory-asn
        title: Shodan info about ASN
        docs:
          desc: Returns the Autonomous System Number (ASN) for the host's IP address.
        filters: asset.platform == "shodan-host"
        mql: |
          shodan.host.asn
      - uid: mondoo-shodan-inventory-tags
        title: Shodan info about Tags
        docs:
          desc: Returns Shodan-assigned tags describing the host's characteristics and services.
        filters: asset.platform == "shodan-host"
        mql: |
          shodan.host.tags
      - uid: mondoo-shodan-inventory-isp
        title: Shodan info about ISP
        docs:
          desc: Returns the Internet Service Provider hosting the IP address.
        filters: asset.platform == "shodan-host"
        mql: |
          shodan.host.isp
      - uid: mondoo-shodan-inventory-org
        title: Shodan info about Org
        docs:
          desc: Returns the organization associated with the IP address.
        filters: asset.platform == "shodan-host"
        mql: |
          shodan.host.org
      - uid: mondoo-shodan-inventory-ip
        title: Shodan info about IP
        docs:
          desc: Returns the IP address of the scanned host.
        filters: asset.platform == "shodan-host"
        mql: |
          shodan.host.ip
      - uid: mondoo-shodan-inventory-os
        title: Shodan info about OS
        docs:
          desc: Returns the operating system detected by Shodan for the host.
        filters: asset.platform == "shodan-host"
        mql: |
          shodan.host.os
      - uid: mondoo-shodan-inventory-ports
        title: Shodan info about Ports
        docs:
          desc: Returns open ports discovered by Shodan on the host.
        filters: asset.platform == "shodan-host"
        mql: |
          shodan.host.ports
      - uid: mondoo-shodan-inventory-vulns
        title: Shodan info about vulnerabilities
        docs:
          desc: Returns known vulnerabilities (CVEs) associated with services on the host.
        filters: asset.platform == "shodan-host"
        mql: |
          shodan.host.vulnerabilities
      - uid: mondoo-shodan-inventory-nsrecords
        title: Shodan info about DNS NS records
        docs:
          desc: Returns nameserver (NS) records for the domain from Shodan.
        filters: asset.platform == "shodan-domain"
        mql: |
          shodan.domain.nsrecords
      - uid: mondoo-shodan-inventory-subdomains
        title: Shodan info about Subdomains
        docs:
          desc: Returns subdomains discovered by Shodan for the domain.
        filters: asset.platform == "shodan-domain"
        mql: |
          shodan.domain.subdomains
      - uid: mondoo-shodan-inventory-domain-tags
        title: Shodan info about Tags
        docs:
          desc: Returns Shodan-assigned tags for the domain.
        filters: asset.platform == "shodan-domain"
        mql: |
          shodan.domain.tags
