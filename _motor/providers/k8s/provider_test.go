// Copyright (c) Mondoo, Inc.
// SPDX-License-Identifier: BUSL-1.1

//go:build debugtest
// +build debugtest

package k8s

import (
	"context"
	"fmt"
	"os"
	"testing"

	"github.com/stretchr/testify/assert"
	"github.com/stretchr/testify/require"
	"go.mondoo.com/cnquery/motor/providers"
)

func TestKubernetes(t *testing.T) {
	os.Setenv("DEBUG", "1")
	p, err := New(context.Background(), &providers.Config{
		Backend: providers.ProviderType_K8S,
	})
	require.NoError(t, err)

	id, err := p.Identifier()
	require.NoError(t, err)
	fmt.Println(id)

	res, err := p.Resources("daemonsets", "", "")
	require.NoError(t, err)
	fmt.Println(res)

	name, err := p.Name()
	require.NoError(t, err)
	assert.Equal(t, "minikube", name)
}

func TestKubernetesManifest(t *testing.T) {
	p, err := New(context.Background(), &providers.Config{
		Backend: providers.ProviderType_K8S,
		Options: map[string]string{
			OPTION_MANIFEST: "./resources/testdata/daemonset.yaml",
		},
	})
	require.NoError(t, err)

	id, err := p.Identifier()
	require.NoError(t, err)
	fmt.Println(id)

	res, err := p.Resources("daemonsets", "", "")
	require.NoError(t, err)
	fmt.Println(res)

	name, err := p.Name()
	require.NoError(t, err)
	assert.Equal(t, "K8s Manifest testdata", name)
}

func TestKubernetesAdmission(t *testing.T) {
	p, err := New(context.Background(), &providers.Config{
		Backend: providers.ProviderType_K8S,
		Options: map[string]string{
			OPTION_ADMISSION: "ewogICAiYXBpVmVyc2lvbiI6ICJhZG1pc3Npb24uazhzLmlvL3YxIiwKICAgImtpbmQiOiAiQWRtaXNzaW9uUmV2aWV3IiwKICAgICAgInJlcXVlc3QiOnsKICAgICAgICAgInVpZCI6IjdmMTg3YzhlLThiM2YtNGEyNi1hZDkyLWEwNWRkZTcwOWIxZSIsCiAgICAgICAgICJraW5kIjp7CiAgICAgICAgICAgICJncm91cCI6IiIsCiAgICAgICAgICAgICJ2ZXJzaW9uIjoidjEiLAogICAgICAgICAgICAia2luZCI6IlBvZCIKICAgICAgICAgfSwKICAgICAgICAgInJlc291cmNlIjp7CiAgICAgICAgICAgICJncm91cCI6IiIsCiAgICAgICAgICAgICJ2ZXJzaW9uIjoidjEiLAogICAgICAgICAgICAicmVzb3VyY2UiOiJwb2RzIgogICAgICAgICB9LAogICAgICAgICAicmVxdWVzdEtpbmQiOnsKICAgICAgICAgICAgImdyb3VwIjoiIiwKICAgICAgICAgICAgInZlcnNpb24iOiJ2MSIsCiAgICAgICAgICAgICJraW5kIjoiUG9kIgogICAgICAgICB9LAogICAgICAgICAicmVxdWVzdFJlc291cmNlIjp7CiAgICAgICAgICAgICJncm91cCI6IiIsCiAgICAgICAgICAgICJ2ZXJzaW9uIjoidjEiLAogICAgICAgICAgICAicmVzb3VyY2UiOiJwb2RzIgogICAgICAgICB9LAogICAgICAgICAibmFtZSI6InRlc3QtZGVwLTVmNjU2OTdmOGQtZnhjbHIiLAogICAgICAgICAibmFtZXNwYWNlIjoiZGVmYXVsdCIsCiAgICAgICAgICJvcGVyYXRpb24iOiJDUkVBVEUiLAogICAgICAgICAidXNlckluZm8iOnsKICAgICAgICAgICAgInVzZXJuYW1lIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50Omt1YmUtc3lzdGVtOnJlcGxpY2FzZXQtY29udHJvbGxlciIsCiAgICAgICAgICAgICJ1aWQiOiI0Y2RmNTE3My04OGM3LTQyY2YtYmIzZi0wZTg3M2U2ZTI2NTUiLAogICAgICAgICAgICAiZ3JvdXBzIjpbCiAgICAgICAgICAgICAgICJzeXN0ZW06c2VydmljZWFjY291bnRzIiwKICAgICAgICAgICAgICAgInN5c3RlbTpzZXJ2aWNlYWNjb3VudHM6a3ViZS1zeXN0ZW0iLAogICAgICAgICAgICAgICAic3lzdGVtOmF1dGhlbnRpY2F0ZWQiCiAgICAgICAgICAgIF0KICAgICAgICAgfSwKICAgICAgICAgIm9iamVjdCI6ewogICAgICAgICAgICAia2luZCI6IlBvZCIsCiAgICAgICAgICAgICJhcGlWZXJzaW9uIjoidjEiLAogICAgICAgICAgICAibWV0YWRhdGEiOnsKICAgICAgICAgICAgICAgIm5hbWUiOiJ0ZXN0LWRlcC01ZjY1Njk3ZjhkLWZ4Y2xyIiwKICAgICAgICAgICAgICAgImdlbmVyYXRlTmFtZSI6InRlc3QtZGVwLTVmNjU2OTdmOGQtIiwKICAgICAgICAgICAgICAgIm5hbWVzcGFjZSI6ImRlZmF1bHQiLAogICAgICAgICAgICAgICAidWlkIjoiOWRkNjQ4MDEtZGVmYy00MTNiLWE1YjQtOGRmY2I0MzUwMjgwIiwKICAgICAgICAgICAgICAgImNyZWF0aW9uVGltZXN0YW1wIjoiMjAyMi0wOS0xOVQxNToxMjowNFoiLAogICAgICAgICAgICAgICAibGFiZWxzIjp7CiAgICAgICAgICAgICAgICAgICJhcHAiOiJ0ZXN0LWRlcCIsCiAgICAgICAgICAgICAgICAgICJwb2QtdGVtcGxhdGUtaGFzaCI6IjVmNjU2OTdmOGQiCiAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICJvd25lclJlZmVyZW5jZXMiOlsKICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAiYXBpVmVyc2lvbiI6ImFwcHMvdjEiLAogICAgICAgICAgICAgICAgICAgICAia2luZCI6IlJlcGxpY2FTZXQiLAogICAgICAgICAgICAgICAgICAgICAibmFtZSI6InRlc3QtZGVwLTVmNjU2OTdmOGQiLAogICAgICAgICAgICAgICAgICAgICAidWlkIjoiNTI5MzhiNDAtODZhMy00YTRkLTk2ZDMtY2NjMzI5YTFiNjI2IiwKICAgICAgICAgICAgICAgICAgICAgImNvbnRyb2xsZXIiOnRydWUsCiAgICAgICAgICAgICAgICAgICAgICJibG9ja093bmVyRGVsZXRpb24iOnRydWUKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAibWFuYWdlZEZpZWxkcyI6WwogICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICJtYW5hZ2VyIjoia3ViZS1jb250cm9sbGVyLW1hbmFnZXIiLAogICAgICAgICAgICAgICAgICAgICAib3BlcmF0aW9uIjoiVXBkYXRlIiwKICAgICAgICAgICAgICAgICAgICAgImFwaVZlcnNpb24iOiJ2MSIsCiAgICAgICAgICAgICAgICAgICAgICJ0aW1lIjoiMjAyMi0wOS0xOVQxNToxMjowNFoiLAogICAgICAgICAgICAgICAgICAgICAiZmllbGRzVHlwZSI6IkZpZWxkc1YxIiwKICAgICAgICAgICAgICAgICAgICAgImZpZWxkc1YxIjp7CiAgICAgICAgICAgICAgICAgICAgICAgICJmOm1ldGFkYXRhIjp7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICJmOmdlbmVyYXRlTmFtZSI6ewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgImY6bGFiZWxzIjp7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIuIjp7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZjphcHAiOnsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJmOnBvZC10ZW1wbGF0ZS1oYXNoIjp7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICJmOm93bmVyUmVmZXJlbmNlcyI6ewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiLiI6ewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIms6e1widWlkXCI6XCI1MjkzOGI0MC04NmEzLTRhNGQtOTZkMy1jY2MzMjlhMWI2MjZcIn0iOnsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAiZjpzcGVjIjp7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICJmOmNvbnRhaW5lcnMiOnsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIms6e1wibmFtZVwiOlwicmVkaXNcIn0iOnsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIi4iOnsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJmOmltYWdlIjp7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZjppbWFnZVB1bGxQb2xpY3kiOnsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJmOm5hbWUiOnsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJmOnJlc291cmNlcyI6ewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImY6dGVybWluYXRpb25NZXNzYWdlUGF0aCI6ewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImY6dGVybWluYXRpb25NZXNzYWdlUG9saWN5Ijp7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgImY6ZG5zUG9saWN5Ijp7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAiZjplbmFibGVTZXJ2aWNlTGlua3MiOnsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICJmOnJlc3RhcnRQb2xpY3kiOnsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICJmOnNjaGVkdWxlck5hbWUiOnsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICJmOnNlY3VyaXR5Q29udGV4dCI6ewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgImY6dGVybWluYXRpb25HcmFjZVBlcmlvZFNlY29uZHMiOnsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgXQogICAgICAgICAgICB9LAogICAgICAgICAgICAic3BlYyI6ewogICAgICAgICAgICAgICAidm9sdW1lcyI6WwogICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICJuYW1lIjoia3ViZS1hcGktYWNjZXNzLTlzemRzIiwKICAgICAgICAgICAgICAgICAgICAgInByb2plY3RlZCI6ewogICAgICAgICAgICAgICAgICAgICAgICAic291cmNlcyI6WwogICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzZXJ2aWNlQWNjb3VudFRva2VuIjp7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJleHBpcmF0aW9uU2Vjb25kcyI6MzYwNywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInBhdGgiOiJ0b2tlbiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjb25maWdNYXAiOnsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiJrdWJlLXJvb3QtY2EuY3J0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIml0ZW1zIjpbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImtleSI6ImNhLmNydCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJwYXRoIjoiY2EuY3J0IgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkb3dud2FyZEFQSSI6ewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaXRlbXMiOlsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAicGF0aCI6Im5hbWVzcGFjZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJmaWVsZFJlZiI6ewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiYXBpVmVyc2lvbiI6InYxIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImZpZWxkUGF0aCI6Im1ldGFkYXRhLm5hbWVzcGFjZSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAgICAgICAgICJkZWZhdWx0TW9kZSI6NDIwCiAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAiY29udGFpbmVycyI6WwogICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICJuYW1lIjoicmVkaXMiLAogICAgICAgICAgICAgICAgICAgICAiaW1hZ2UiOiJyZWRpcyIsCiAgICAgICAgICAgICAgICAgICAgICJyZXNvdXJjZXMiOnsKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICJ2b2x1bWVNb3VudHMiOlsKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAibmFtZSI6Imt1YmUtYXBpLWFjY2Vzcy05c3pkcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICJyZWFkT25seSI6dHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIm1vdW50UGF0aCI6Ii92YXIvcnVuL3NlY3JldHMva3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudCIKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgICAgICAidGVybWluYXRpb25NZXNzYWdlUGF0aCI6Ii9kZXYvdGVybWluYXRpb24tbG9nIiwKICAgICAgICAgICAgICAgICAgICAgInRlcm1pbmF0aW9uTWVzc2FnZVBvbGljeSI6IkZpbGUiLAogICAgICAgICAgICAgICAgICAgICAiaW1hZ2VQdWxsUG9saWN5IjoiQWx3YXlzIgogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICJyZXN0YXJ0UG9saWN5IjoiQWx3YXlzIiwKICAgICAgICAgICAgICAgInRlcm1pbmF0aW9uR3JhY2VQZXJpb2RTZWNvbmRzIjozMCwKICAgICAgICAgICAgICAgImRuc1BvbGljeSI6IkNsdXN0ZXJGaXJzdCIsCiAgICAgICAgICAgICAgICJzZXJ2aWNlQWNjb3VudE5hbWUiOiJkZWZhdWx0IiwKICAgICAgICAgICAgICAgInNlcnZpY2VBY2NvdW50IjoiZGVmYXVsdCIsCiAgICAgICAgICAgICAgICJzZWN1cml0eUNvbnRleHQiOnsKICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICJzY2hlZHVsZXJOYW1lIjoiZGVmYXVsdC1zY2hlZHVsZXIiLAogICAgICAgICAgICAgICAidG9sZXJhdGlvbnMiOlsKICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAia2V5Ijoibm9kZS5rdWJlcm5ldGVzLmlvL25vdC1yZWFkeSIsCiAgICAgICAgICAgICAgICAgICAgICJvcGVyYXRvciI6IkV4aXN0cyIsCiAgICAgICAgICAgICAgICAgICAgICJlZmZlY3QiOiJOb0V4ZWN1dGUiLAogICAgICAgICAgICAgICAgICAgICAidG9sZXJhdGlvblNlY29uZHMiOjMwMAogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICJrZXkiOiJub2RlLmt1YmVybmV0ZXMuaW8vdW5yZWFjaGFibGUiLAogICAgICAgICAgICAgICAgICAgICAib3BlcmF0b3IiOiJFeGlzdHMiLAogICAgICAgICAgICAgICAgICAgICAiZWZmZWN0IjoiTm9FeGVjdXRlIiwKICAgICAgICAgICAgICAgICAgICAgInRvbGVyYXRpb25TZWNvbmRzIjozMDAKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAicHJpb3JpdHkiOjAsCiAgICAgICAgICAgICAgICJlbmFibGVTZXJ2aWNlTGlua3MiOnRydWUsCiAgICAgICAgICAgICAgICJwcmVlbXB0aW9uUG9saWN5IjoiUHJlZW1wdExvd2VyUHJpb3JpdHkiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJzdGF0dXMiOnsKICAgICAgICAgICAgICAgInBoYXNlIjoiUGVuZGluZyIsCiAgICAgICAgICAgICAgICJxb3NDbGFzcyI6IkJlc3RFZmZvcnQiCiAgICAgICAgICAgIH0KICAgICAgICAgfSwKICAgICAgICAgIm9sZE9iamVjdCI6bnVsbCwKICAgICAgICAgImRyeVJ1biI6ZmFsc2UsCiAgICAgICAgICJvcHRpb25zIjp7CiAgICAgICAgICAgICJraW5kIjoiQ3JlYXRlT3B0aW9ucyIsCiAgICAgICAgICAgICJhcGlWZXJzaW9uIjoibWV0YS5rOHMuaW8vdjEiCiAgICAgICAgIH0KICAgICAgfQogICAKfQo=",
		},
	})
	require.NoError(t, err)

	id, err := p.Identifier()
	require.NoError(t, err)
	fmt.Println(id)

	res, err := p.Resources("daemonsets", "", "")
	require.NoError(t, err)
	fmt.Println(res)

	name, err := p.Name()
	require.NoError(t, err)
	assert.Equal(t, "K8s Manifest testdata", name)
}
