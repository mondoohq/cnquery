{"resources":{"aws":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws` can be used to assess the configuration of AWS accounts. It provides the `aws.regions` field for returning a list of enabled AWS regions in the account, and the `aws.vpcs` field which provides a list of VPCs configured within the account.\n"},"fields":{"regions":{},"vpcs":{}},"refs":[{"title":"AWS Documentation: Managing AWS Regions","url":"https://docs.aws.amazon.com/general/latest/gr/rande-manage.html"},{"title":"AWS Documentation: Security in Amazon Virtual Private Cloud","url":"https://docs.aws.amazon.com/vpc/latest/userguide/security.html"}],"snippets":[{"title":"List all enabled regions within the AWS account","query":"aws.regions"},{"title":"List of `aws.vpc` resources for all VPCs across all enabled regions","query":"aws.vpcs"},{"title":"List of `aws.vpc` resources for all VPCs across all enabled regions and the values for specified fields","query":"aws.vpcs {\n  arn \n  id \n  state \n  isDefault \n  region \n  flowLogs\n  routeTables\n}\n"},{"title":"Ensure VPC flow logging is enabled in all VPCs","query":"aws.vpcs.all( flowLogs.any(status == \"ACTIVE\") )\n"}],"min_mondoo_version":"5.15.0"},"aws.accessAnalyzer":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.accessAnalyzer` resource returns a list of `aws.accessAnalyzer.analyzer` resources representing all of the AWS IAM Access Analyzers configured across the AWS account.\n"},"fields":{"analyzers":{}},"refs":[{"title":"Using AWS IAM Access Analyzer","url":"https://docs.aws.amazon.com/IAM/latest/UserGuide/what-is-access-analyzer.html"}],"snippets":[{"title":"Return a list of `aws.accessAnalyzer.analyzer` resources representing all of the AWS IAM Access Analyzers configured across the AWS account","query":"aws.accessAnalyzer.analyzers"},{"title":"Return a list of `aws.accessAnalyzer.analyzer` resources and the value for specified fields","query":"aws.accessAnalyzer.analyzers { \n  arn \n  name \n  status \n  type \n}\n"},{"title":"Ensure that IAM Access analyzer is enabled for all regions","query":"aws.accessAnalyzer.analyzers.all(\n  status == \"ACTIVE\"\n)\n"}],"min_mondoo_version":"5.15.0"},"aws.accessanalyzer.analyzer":{"platform":{"name":["aws"]},"fields":{"arn":{},"name":{},"status":{},"tags":{"min_mondoo_version":"5.16.0"},"type":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.account":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.account` resource provides configuration for AWS accounts including the account number, and configured aliases.\n"},"fields":{"aliases":{},"id":{},"organization":{"min_mondoo_version":"6.11.0"}},"snippets":[{"title":"Return the account id (number) and any configured account aliases","query":"aws.account { \n  id \n  aliases \n}\n"}],"min_mondoo_version":"5.15.0"},"aws.acm":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.acm` resource can be used to assess the configuration of the AWS Certificates Manager service within the account. This resource returns a list of `aws.acm.certificate` resources for all ACM certificates found within the account."},"fields":{"certificates":{}},"refs":[{"title":"What Is AWS Certificate Manager?","url":"https://docs.aws.amazon.com/acm/latest/userguide/acm-overview.html"},{"title":"Security in AWS Certificate Manager","url":"https://docs.aws.amazon.com/acm/latest/userguide/security.html"}],"snippets":[{"title":"Return a list of `aws.acm.certificate` resources within the AWS account","query":"aws.acm.certificates"},{"title":"Return a list of `aws.acm.certificate` resources within the AWS account along with values for specified fields","query":"aws.acm.certificates {\n  arn\n  notBefore\n  notAfter \n  createdAt\n  domainName\n  status\n  subject\n  certificate() \n}\n"},{"title":"Checks whether ACM Certificates in your account are marked for expiration within 90 days","query":"aws.acm.certificates.\n  where( status != /PENDING_VALIDATION/ ).\n  all (notAfter - notBefore \u003c= 90 * time.day)\n"}],"min_mondoo_version":"5.15.0"},"aws.acm.certificate":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.acm.certificate` resource provides fields for assessing the configuration of AWS ACM certificates. For usage see the `aws.acm` resource documentation.\n"},"fields":{"arn":{},"certificate":{},"createdAt":{},"domainName":{},"notAfter":{},"notBefore":{},"status":{},"subject":{},"tags":{"min_mondoo_version":"5.16.0"}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.apigateway":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.apigateway` resource can be used to assess the configuration of the AWS API Gateway service."},"fields":{"restApis":{}},"refs":[{"title":"What is Amazon API Gateway?","url":"https://docs.aws.amazon.com/apigateway/latest/developerguide/welcome.html"},{"title":"Security in Amazon API Gateway","url":"https://docs.aws.amazon.com/apigateway/latest/developerguide/security.html"}],"snippets":[{"title":"Return a list of `aws.apigateway.restapi` resources for all REST APIs configured with the account across all enabled regions","query":"aws.apigateway.restApis"},{"title":"Return a list of `aws.apigateway.restapi` resources for all REST APIs configured with the account across all enabled regions and the value for specified fields","query":"aws.apigateway.restApis {\n  createdDate\n  description\n  stages\n  region\n  arn\n  id\n  name\n}\n"},{"title":"Checks that all methods in Amazon API Gateway have caching enabled and encrypted","query":"aws.apigateway.restApis.all(stages.all(\n  methodSettings['CachingEnabled'] == true \u0026\u0026 \n    methodSettings['CacheDataEncrypted'] == true\n))\n"},{"title":"Checks that all methods in Amazon API Gateway have logging enabled","query":"aws.apigateway.restApis.all(stages.all(\nmethodSettings['LoggingLevel'] == \"ERROR\" || methodSettings['LoggingLevel'] == \"INFO\"\n))\n"}],"min_mondoo_version":"5.15.0"},"aws.apigateway.restapi":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.apigateway.restapi` resource provides fields representing an individual REST API configured within the AWS account. For usage see the `aws.apigateway` resource documentation.\n"},"fields":{"arn":{},"createdDate":{},"description":{},"id":{},"name":{},"region":{},"stages":{},"tags":{"min_mondoo_version":"5.16.0"}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.apigateway.stage":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.apigateway.stage` resource provides fields representing an individual stage configured on a REST API. For usage see the `aws.apigateway` resource documentation.\n"},"fields":{"arn":{},"deploymentId":{},"description":{},"methodSettings":{},"name":{},"tracingEnabled":{}},"snippets":[{"title":"Return a list of AWS API Gateway REST APIs configured across all enabled regions in the AWS account and the values for the arn and stages","query":"aws.apigateway.restApis { \n  arn \n  stages \n}\n"}],"is_private":true,"min_mondoo_version":"5.15.0"},"aws.applicationAutoscaling":{"platform":{"name":["aws"]},"fields":{"namespace":{},"scalableTargets":{}},"min_mondoo_version":"6.11.1"},"aws.applicationautoscaling.target":{"platform":{"name":["aws"]},"fields":{"arn":{},"maxCapacity":{},"minCapacity":{},"namespace":{},"scalableDimension":{},"suspendedState":{}},"is_private":true,"min_mondoo_version":"6.11.1"},"aws.autoscaling":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.autoscaling` resource can be used to assess the configuration of AWS auto scaling groups within an AWS account. This resource provides the `.groups` field which returns a list of `aws.autoscaling.group` resources representing all auto scaling groups configured across all enabled regions across the account.\n"},"fields":{"groups":{}},"refs":[{"title":"Security in Amazon EC2 Auto Scaling","url":"https://docs.aws.amazon.com/autoscaling/ec2/userguide/security.html"},{"title":"Compliance validation for Amazon EC2 Auto Scaling","url":"https://docs.aws.amazon.com/autoscaling/ec2/userguide/ec2-auto-scaling-compliance.html"}],"snippets":[{"title":"Return a list of `aws.autoscaling.group` resources representing all auto scaling groups configured across all enabled regions across the account and the value for specified fields","query":"aws.autoscaling.groups { \n  arn \n  healthCheckType \n  loadBalancerNames \n  name \n}\n"},{"title":"Checks that all autoscaling groups assoc with a load balancer use health checks","query":"aws.autoscaling.groups.where(loadBalancerNames.length \u003e 0) { \n  healthCheckType == \"ELB\" \n}\n"}],"min_mondoo_version":"5.15.0"},"aws.autoscaling.group":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.autoscaling.group` resource provides fields representing an individual AWS auto scaling group within the account. For usage see the `aws.autoscaling` resource documentation.\n"},"fields":{"arn":{},"healthCheckType":{},"loadBalancerNames":{},"name":{},"tags":{"min_mondoo_version":"5.16.0"}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.cloudtrail":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.cloudtrail` resource can be used to assess the configuration of AWS CloudTrails deployed within an AWS account. The resource provides the `.trails` field which creates a list of `aws.cloudtrail.trail` resources representing all CloudTrails configured across every enabled region.\n"},"fields":{"trails":{}},"refs":[{"title":"Security best practices in AWS CloudTrail","url":"https://docs.aws.amazon.com/awscloudtrail/latest/userguide/best-practices-security.html"}],"snippets":[{"title":"Return a list of `aws.cloudtrail.trail` resources representing all AWS Cloud Trails configured across all enabled regions and the values for specified fields","query":"aws.cloudtrail.trails {\n  arn\n  name\n  kmsKey\n  isMultiRegionTrail\n  isOrganizationTrail\n  logFileValidationEnabled\n  includeGlobalServiceEvents\n  s3bucket\n  snsTopicARN\n  status\n  logGroup\n  cloudWatchLogsRoleArn\n  eventSelectors\n  region\n}\n"},{"query":"aws.cloudtrail.trails.any( \n  isMultiRegionTrail \u0026\u0026 status['IsLogging'] \n)\n"}],"min_mondoo_version":"5.15.0"},"aws.cloudtrail.trail":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.cloudtrail.trail` object represents an individual AWS CloudTrail configured within an account. For usage see the `aws.cloudtrail` resource.\n"},"fields":{"arn":{},"cloudWatchLogsRoleArn":{},"eventSelectors":{},"includeGlobalServiceEvents":{},"isMultiRegionTrail":{},"isOrganizationTrail":{},"kmsKey":{},"logFileValidationEnabled":{},"logGroup":{},"name":{},"region":{},"s3bucket":{},"snsTopicARN":{},"status":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.cloudwatch":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.cloudwatch` resource is used to assess the configuration of the AWS CloudWatch service.\n"},"fields":{"alarms":{},"logGroups":{},"metrics":{}},"snippets":[{"title":"Return a list of `aws.cloudwatch.loggroup` resources representing individual CloudWatch log groups configured across all enabled regions","query":"aws.cloudwatch.logGroups"},{"title":"Return a list of `aws.cloudwatch.metric` resources representing individual CloudWatch metrics configured across all enabled regions","query":"aws.cloudwatch.metrics"},{"title":"Checks that all cloudwatch alarms have at least one action enabled","query":"aws.cloudwatch.alarms.all(\n  actions.length \u003e 0 == true \u0026\u0026\n  insufficientDataActions.length \u003e 0 == props.cloudwatchAlarmInsufficientDataActionRequired \u0026\u0026\n  okActions.length \u003e 0 == props.cloudwatchAlarmOkActionRequired\n)\n"}],"min_mondoo_version":"5.15.0"},"aws.cloudwatch.loggroup":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.cloudwatch.loggroup` object represents an individual AWS CloudWatch log group configured within an account. For usage see the `aws.cloudwatch` resource.\n"},"fields":{"arn":{},"kmsKey":{},"metricsFilters":{},"name":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.cloudwatch.loggroup.metricsfilter":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.cloudwatch.metricsfilter` object represents an individual AWS CloudWatch metrics filter configured within an account. For usage see the `aws.cloudwatch` resource.\n"},"fields":{"filterName":{},"filterPattern":{},"id":{},"metrics":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.cloudwatch.metric":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.cloudwatch.metric` object represents an individual AWS CloudWatch metric configured within an account. For usage see the `aws.cloudwatch` resource.\n"},"fields":{"alarms":{},"dimensions":{"min_mondoo_version":"5.17.1"},"name":{},"namespace":{},"region":{},"statistics":{"min_mondoo_version":"5.17.1"}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.cloudwatch.metric.datapoint":{"platform":{"name":["aws"]},"fields":{"average":{},"id":{},"maximum":{},"minimum":{},"sum":{},"timestamp":{},"unit":{}},"is_private":true,"min_mondoo_version":"5.17.1"},"aws.cloudwatch.metricdimension":{"platform":{"name":["aws"]},"fields":{"name":{},"value":{}},"min_mondoo_version":"5.17.1"},"aws.cloudwatch.metricsalarm":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.cloudwatch.metricsalarm` object represents an individual AWS CloudWatch metric alarm configured within an account. For usage see the `aws.cloudwatch` resource.\n"},"fields":{"actions":{},"arn":{},"insufficientDataActions":{},"metricName":{},"metricNamespace":{},"name":{},"okActions":{},"region":{},"state":{},"stateReason":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.cloudwatch.metricstatistics":{"platform":{"name":["aws"]},"fields":{"datapoints":{},"label":{},"name":{},"namespace":{},"region":{}},"min_mondoo_version":"5.17.1"},"aws.codebuild":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.codebuild` resource is used to assess the configuration of the AWS CodeBuild service and the projects within. \n"},"fields":{"projects":{}},"refs":[{"title":"Security in AWS CodeBuild","url":"https://docs.aws.amazon.com/codebuild/latest/userguide/security.html"}],"snippets":[{"title":"Return a list of `aws.codebuild.project` resources representing all AWS CodeBuild projects configured across all enabled regions within the account and the values for specified fields","query":"aws.codebuild.projects {\n  arn\n  description\n  name\n  environment\n  region\n  source\n}\n"},{"title":"Checks that all projects containing env variables AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY are not in plaintext","query":"aws.codebuild.projects { \n  environment ['EnvironmentVariables'].where(_['Name'] == \"AWS_ACCESS_KEY_ID\") { _['Type'] != \"PLAINTEXT\"}\n  environment ['EnvironmentVariables'].where(_['Name'] == \"AWS_SECRET_ACCESS_KEY\") { _['Type'] != \"PLAINTEXT\"} \n}\n"},{"title":"Checks that all projects using github or bitbucket as the source use oauth","query":"aws.codebuild.projects.where( source['Type'] == \"BITBUCKET\" || source['Type'] == \"GITHUB\" ) { \n  source['Auth']['Type'] == \"OAUTH\"\n}\n"}],"min_mondoo_version":"5.15.0"},"aws.codebuild.project":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.codebuild.project` resource provides fields representing an individual AWS CodeBuild project configured within the account. For usage see the `aws.codebuild` documentation.\n"},"fields":{"arn":{},"description":{},"environment":{},"name":{},"region":{},"source":{},"tags":{"min_mondoo_version":"5.16.0"}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.config":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.config` resource is used to assess the configuration of the AWS Config service. The resource provides the `.recorders` field which returns a list of `aws.config.recorder` resources representing all AWS Config recorders configured across all enabled regions, as well as the `.rules` field which returns a list of `aws.config.rule` resources representing all AWS Config rules configured across all enabled regions in the account.\n"},"fields":{"recorders":{},"rules":{}},"refs":[{"title":"Security in AWS Config","url":"https://docs.aws.amazon.com/config/latest/developerguide/security.html"},{"title":"AWS Config best practices","url":"https://aws.amazon.com/blogs/mt/aws-config-best-practices/"}],"snippets":[{"title":"Return a list of `aws.config.rule` resources representing AWS Config rules configured across all enabled regions and the value for specified fields","query":"aws.config.rules {\n  arn \n  state \n  source\n}\n"},{"title":"Return a list of AWS Config recorders configured across all enabled regions and the value for specified fields","query":"aws.config.recorders {\n  name \n  roleArn \n  allSupported \n  includeGlobalResourceTypes \n  recording \n  lastStatus \n  region \n}\n"},{"title":"Ensure AWS Config is enabled in all regions","query":"aws.config.recorders.any(allSupported == true \u0026\u0026 includeGlobalResourceTypes == true)\naws.config.recorders.where(allSupported == true \u0026\u0026 includeGlobalResourceTypes == true).all(\n  recording == true \u0026\u0026 lastStatus == \"SUCCESS\"\n)\n"}],"min_mondoo_version":"5.15.0"},"aws.config.recorder":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.config.recorder` resource provides fields representing an individual AWS Config recorder configured within an account. For usage see the `aws.config` resource documentation. \n"},"fields":{"allSupported":{},"includeGlobalResourceTypes":{},"lastStatus":{},"name":{},"recording":{},"region":{},"roleArn":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.config.rule":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.config.rule` resource provides fields representing an individual AWS Config rule configured within an account. For usage see the `aws.config` resource documentation. \n"},"fields":{"arn":{},"source":{},"state":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.dms":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.dms` resource is used to assess the configuration of the AWS Database Migration service.\n"},"fields":{"replicationInstances":{}},"refs":[{"title":"Security in AWS Database Migration Service","url":"https://docs.aws.amazon.com/dms/latest/userguide/CHAP_Security.html"}],"snippets":[{"title":"Return a list of AWS Database Migration service replication instances","query":"aws.dms.replicationInstances"},{"title":"Checks whether AWS Database Migration Service replication instances are public","query":"aws.dms.replicationInstances.none(\n  _['PubliclyAccessible'] == true\n)\n"}],"min_mondoo_version":"5.15.0"},"aws.dynamodb":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.dynamodb` resource can be used to assess the configuration of the AWS DynamoDB.\n"},"fields":{"backups":{},"globalTables":{},"limits":{},"tables":{}},"refs":[{"title":"Security and Compliance in Amazon DynamoDB","url":"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/security.html"}],"snippets":[{"title":"Return a list of `aws.dynamodb.table` resources and the values for specified fields","query":"aws.dynamodb.tables {\n  arn \n  name \n  region \n  backups \n  sseDescription \n  provisionedThroughput \n  continuousBackups \n}\n"},{"title":"Return a list of `aws.dynamodb.limit` resources and the values for specified fields","query":"aws.dynamodb.limits {\n  arn \n  region \n  accountMaxRead \n  accountMaxWrite \n  tableMaxRead\n  tableMaxWrite \n}\n"},{"title":"Return a list of `aws.dynamodb.globaltable` resources and the value for specified fields","query":"aws.dynamodb.globaltables {\n  arn \n  name \n  replicaSettings \n}\n"},{"title":"Checks that all DynamoDB tables are encrypted with AWS Key Management Service (KMS)","query":"aws.dynamodb.tables.all( \n  sseDescription['SSEType'] == 'KMS' \u0026\u0026 sseDescription['Status'] == 'ENABLED'\n)\n"}],"min_mondoo_version":"5.15.0"},"aws.dynamodb.globaltable":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.dynamodb.globaltable` resource provides fields representing a DynamoDB Global Table. For usage see `aws.dynamodb` resource documentation.\n"},"fields":{"arn":{},"name":{},"replicaSettings":{},"tags":{"min_mondoo_version":"5.16.0"}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.dynamodb.limit":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.dynamodb.limit` resource provides fields representing a DynamoDB limit configuration. For usage see `aws.dynamodb` resource documentation.\n"},"fields":{"accountMaxRead":{},"accountMaxWrite":{},"arn":{},"region":{},"tableMaxRead":{},"tableMaxWrite":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.dynamodb.table":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.dynamodb.table` resource provides fields representing a DynamoDB Table. For usage see `aws.dynamodb` resource documentation.\n"},"fields":{"arn":{},"backups":{},"continuousBackups":{},"name":{},"provisionedThroughput":{},"region":{},"sseDescription":{},"tags":{"min_mondoo_version":"5.16.0"}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.ec2":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.ec2` resource can be used to assess the configuration of AWS EC2 instances.\n"},"fields":{"ebsEncryptionByDefault":{},"instances":{},"internetGateways":{},"networkAcls":{},"securityGroups":{},"snapshots":{},"volumes":{},"vpnConnections":{}},"refs":[{"title":"Security in Amazon EC2","url":"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security.html"},{"title":"Security in Amazon Virtual Private Cloud","url":"https://docs.aws.amazon.com/vpc/latest/userguide/security.html"}],"snippets":[{"title":"Return a list of all EC2 instances across all enabled regions in the account and the value for specified fields","query":"aws.ec2.instances {\n  arn\n  instanceId \n  detailedMonitoring \n  region \n  publicIp \n  ssm \n  vpc \n  httpTokens \n  patchState \n  state \n  deviceMappings \n  securityGroups\n  publicDnsName \n  instanceStatus\n  stateReason \n  stateTransitionReason \n  ebsOptimized \n  instanceType \n  tags \n  image\n  launchTime \n}\n"},{"title":"Return a list of security groups across every enabled region and the value for specified fields","query":"aws.ec2.securityGroups {\n  arn\n  region\n  vpc\n  id\n}\n"},{"title":"Return a list of all EBS volumes along with the associated ARN and the region the volume exists in","query":"aws.ec2.volumes {\n  arn\n  region \n}\n"},{"title":"Ensure the default security group of every VPC restricts all traffic","query":"aws.ec2.securityGroups.where(name == \"default\") {\n  ipPermissions.all(ipRanges.length == 0 \u0026\u0026 ipv6Ranges.length == 0 \u0026\u0026 fromPort == 0 \u0026\u0026 toPort == 0)\n  ipPermissionsEgress.all(ipRanges.length == 0 \u0026\u0026 ipv6Ranges.length == 0 \u0026\u0026 fromPort == 0 \u0026\u0026 toPort == 0)\n}\n"}],"min_mondoo_version":"5.15.0"},"aws.ec2.image":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.ec2.image` resource provides fields for assessing AMIs within an account. For usage see `aws.ec2` resource.\n"},"fields":{"architecture":{},"arn":{},"id":{},"name":{},"ownerAlias":{"min_mondoo_version":"5.22.0"},"ownerId":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.ec2.instance":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.ec2.instance` resource provides fields for assessing the configuration of EC2 instances within an account. For usage see `aws.ec2` resource.\n"},"fields":{"arn":{},"detailedMonitoring":{},"deviceMappings":{},"ebsOptimized":{},"httpTokens":{},"image":{},"instanceId":{},"instanceStatus":{},"instanceType":{},"launchTime":{},"patchState":{},"privateDnsName":{"min_mondoo_version":"5.37.0"},"privateIp":{"min_mondoo_version":"5.37.0"},"publicDnsName":{},"publicIp":{},"region":{},"securityGroups":{},"ssm":{},"state":{},"stateReason":{},"stateTransitionReason":{},"tags":{},"vpc":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.ec2.instance.device":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.ec2.instance.device` resource provides fields for assessing the configuration of devices attached to EC2 instances within an account. For usage see `aws.ec2` resource.\n"},"fields":{"deleteOnTermination":{},"deviceName":{},"status":{},"volumeId":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.ec2.internetgateway":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.ec2.internetgateway` resource provides fields for assessing the configuration of internet gateways within an AWS account. For usage see `aws.ec2` resource.\n"},"fields":{"arn":{},"attachments":{},"id":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.ec2.networkacl":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.ec2.networkacl` resource provides fields for assessing the configuration of VPC network ACLs within an AWS account. For usage see `aws.ec2` resource.\n"},"fields":{"arn":{},"entries":{},"id":{},"region":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.ec2.networkacl.entry":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.ec2.networkacl.entry` resource provides fields for assessing the configuration of network ACL entries within an AWS account. For usage see `aws.ec2` resource.\n"},"fields":{"egress":{},"id":{},"portRange":{},"ruleAction":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.ec2.networkacl.entry.portrange":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.ec2.networkacl.portrange` resource provides fields for assessing the port range configuration of network ACL entries within an AWS account. For usage see `aws.ec2` resource.\n"},"fields":{"from":{},"id":{},"to":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.ec2.securitygroup":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.ec2.securitygroup` resource provides fields for assessing the configuration of security groups within an AWS account. For usage see `aws.ec2` resource.\n"},"fields":{"arn":{},"description":{},"id":{},"ipPermissions":{},"ipPermissionsEgress":{},"isAttachedToNetworkInterface":{},"name":{},"region":{},"tags":{},"vpc":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.ec2.securitygroup.ippermission":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.ec2.securitygroup.ippermission` resource provides fields for assessing the configuration of ip permissions for security groups within an AWS account. For usage see `aws.ec2` resource.\n"},"fields":{"fromPort":{},"id":{},"ipProtocol":{},"ipRanges":{},"ipv6Ranges":{},"toPort":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.ec2.snapshot":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.ec2.snapshot` resource provides fields for assessing the configuration of EBS snapshots within an AWS account. For usage see `aws.ec2` resource.\n"},"fields":{"arn":{},"createVolumePermission":{},"id":{},"region":{},"startTime":{},"tags":{},"volumeId":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.ec2.vgwtelemetry":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.ec2.vgwtelemetry` resource provides fields for assessing the configuration of telemetry for VPN tunnels within an AWS account. For usage see `aws.ec2` resource.\n"},"fields":{"outsideIpAddress":{},"status":{},"statusMessage":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.ec2.volume":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.ec2.volume` resource provides fields for assessing the configuration of EBS volumes within an AWS account. For usage see `aws.ec2` resource.\n"},"fields":{"arn":{},"attachments":{},"availabilityZone":{},"createTime":{"min_mondoo_version":"5.25.0"},"encrypted":{},"id":{},"state":{},"tags":{},"volumeType":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.ec2.vpnconnection":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.ec2.vpnconnection` resource provides fields for assessing the configuration of VPN connections within an AWS account. For usage see `aws.ec2` resource.\n"},"fields":{"arn":{},"vgwTelemetry":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.efs":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.efs` resource can be used to assess the configuration of Amazon Elastic File System deployments.\n"},"fields":{"filesystems":{}},"refs":[{"title":"Security in Amazon EFS","url":"https://docs.aws.amazon.com/efs/latest/ug/security-considerations.html"}],"snippets":[{"title":"Return a list of `aws.efs.filesystem` resources representing any EFS deployments across all enabled regions in the account","query":"aws.efs.filesystems {\n  name\n  id\n  arn\n  encrypted\n  kmsKey\n  backupPolicy\n  region\n}\n"},{"title":"Checks whether all EFS systems are configured to encrypt file data using KMS","query":"aws.efs.filesystems.all(\n  encrypted == true \u0026\u0026 kmsKey.arn == /^arn:aws:kms:.*/ \n)\n"}],"min_mondoo_version":"5.15.0"},"aws.efs.filesystem":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.efs.filesystem` resource provides fields for assessing the configuration of individual EFS deployments. For usage see the `aws.efs` resource documentation. \n"},"fields":{"arn":{},"backupPolicy":{},"encrypted":{},"id":{},"kmsKey":{},"name":{},"region":{},"tags":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.eks":{"platform":{"name":["aws"]},"fields":{"clusters":{}},"min_mondoo_version":"5.31.0"},"aws.eks.cluster":{"platform":{"name":["aws"]},"fields":{"arn":{},"createdAt":{},"encryptionConfig":{},"endpoint":{},"logging":{},"name":{},"networkConfig":{},"platformVersion":{},"region":{},"resourcesVpcConfig":{},"status":{},"tags":{},"version":{}},"is_private":true,"min_mondoo_version":"5.31.0"},"aws.elasticache":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.elasticache` resource can be used to assess the configuration of Amazon ElastiCache. \n"},"fields":{"clusters":{}},"refs":[{"title":"Security in Amazon ElastiCache","url":"https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/redis-security.html"}],"snippets":[{"title":"Checks if the ElastiCache Redis clusters have automatic backup turned on","query":"aws.elasticache.clusters.all(\n  _['SnapshotRetentionLimit'] \u003e _['SnapshotRetentionPeriod']\n)\n"}],"min_mondoo_version":"5.15.0"},"aws.elb":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.elb` resource can be used to assess the configuration of Amazon Elastic Load Balancers within an AWS account.\n"},"fields":{"classicLoadBalancers":{},"loadBalancers":{}},"refs":[{"title":"Security in Elastic Load Balancing","url":"https://docs.aws.amazon.com/elasticloadbalancing/latest/userguide/security.html"}],"snippets":[{"title":"Return a list of all application, gateway, and network Elastic Load Balancers deployed across every enabled region and the values for specified fields","query":"aws.elb.loadbalancers {\n  arn\n  dnsName\n  listenerDescriptions\n  name\n  scheme\n  attributes\n}\n"},{"title":"Return a list of all classic Elastic Load Balancers deployed across every enabled region and the values for specified fields","query":"aws.elb.classicLoadBalancers {\n  arn\n  dnsName\n  listenerDescriptions\n  name\n  scheme\n  attributes\n}\n"},{"title":"Checks whether HTTP to HTTPS redirection is configured on all application load balancer http listeners","query":"aws.elb.loadBalancers.all( listenerDescriptions.any ( \n  _['Protocol'] == \"HTTPS\" || _['Protocol'] == \"SSL\" ) \n)\n"},{"title":"Checks that all Classic Load Balancers use SSL certificates provided by AWS Cert Mgr","query":"aws.elb.classicLoadBalancers.all( listenerDescriptions.any ( \n  _['Listener']['Protocol'] == \"HTTPS\" || _['Listener']['Protocol'] == \"SSL\" ) \n)\n"}],"min_mondoo_version":"5.15.0"},"aws.elb.loadbalancer":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.elb.loadbalancer` resource provides fields for assessing the configuration of individual classic, application, gateway, and network Amazon Elastic Load Balancers. For usage see the `aws.elb` documentation.\n"},"fields":{"arn":{},"attributes":{},"dnsName":{},"listenerDescriptions":{},"name":{},"scheme":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.emr":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.emr` resource can be used to assess the configuration of Amazon EMR clusters. This resource provides a list of `aws.emr.cluster` resources representing EMR clusters deployed across all enabled regions.\n"},"fields":{"clusters":{}},"refs":[{"title":"Security in Amazon EMR","url":"https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-security.html"}],"snippets":[{"title":"Return a list of EMR clusters deployed across all enabled regions and the value for specified fields","query":"aws.emr.clusters {\n  arn\n  name\n  normalizedInstanceHours\n  outpostArn\n  status\n  masterInstances\n  id\n}\n"},{"title":"Checks whether EMR cluster master nodes have public ips","query":"aws.emr.clusters.all(\n  masterInstances { _['PublicIpAddress'] == null }\n)\n"}],"min_mondoo_version":"5.15.0"},"aws.emr.cluster":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.emr.cluster` resource provides fields for assessing the configuration of individual Amazon EMR clusters. For usage see the `aws.emr` resource documentation.\n"},"fields":{"arn":{},"id":{},"masterInstances":{},"name":{},"normalizedInstanceHours":{},"outpostArn":{},"status":{},"tags":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.es":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.es` resource can be used to assess the configuration of Amazon ElasticSearch domains. This resource provides a list of `aws.es.domain` resources representing ElasticSearch domains deployed across all enabled regions.\n"},"fields":{"domains":{}},"refs":[{"title":"Amazon Security Blog on ElasticSearch","url":"https://aws.amazon.com/blogs/security/tag/amazon-elasticsearch-service/"}],"min_mondoo_version":"5.15.0"},"aws.es.domain":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.es.domain` provides fields for assessing the configuration of individual Amazon ElasticSearch domains. For usage see the `aws.es` resource documentation\n"},"fields":{"arn":{},"encryptionAtRestEnabled":{},"endpoint":{},"name":{},"nodeToNodeEncryptionEnabled":{},"region":{},"tags":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.guardduty":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.guardduty` resource can be used to assess the configuration of the AWS GuardDuty service. The resource provides a list of `aws.guardduty.detector` resources representing GuardDuty Detectors deployed across all enabled regions.\n"},"fields":{"detectors":{}},"refs":[{"title":"Security in Amazon GuardDuty","url":"https://docs.aws.amazon.com/guardduty/latest/ug/security.html"}],"snippets":[{"title":"Return a list of Amazon GuardDuty Detectors along with the values for specified fields","query":"aws.guardduty.detectors {\n  id\n  region\n  status\n  findingPublishingFrequency\n  unarchivedFindings\n}\n"},{"title":"Checks that guardduty is enabled in all regions","query":"aws.guardduty.detectors.all( status == \"ENABLED\" )\n"}],"min_mondoo_version":"5.15.0"},"aws.guardduty.detector":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.guardduty.dectector` provides fields for assessing the configuration of individual Amazon GuardDuty Detectors. For usage see the `aws.guardduty` resource documentation\n"},"fields":{"findingPublishingFrequency":{},"id":{},"region":{},"status":{},"unarchivedFindings":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.iam":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.iam` resource can be used to assess the configuration of the AWS IAM service. The resource provides a list of `aws.iam.user` resources representing GuardDuty Detectors deployed across all enabled regions.\n"},"fields":{"accountPasswordPolicy":{},"accountSummary":{},"attachedPolicies":{},"credentialReport":{},"groups":{},"policies":{},"roles":{},"serverCertificates":{},"users":{},"virtualMfaDevices":{}},"refs":[{"title":"Security in IAM and AWS STS","url":"https://docs.aws.amazon.com/IAM/latest/UserGuide/security.html"}],"snippets":[{"title":"Return a list of `aws.iam.user` resources representing IAM users in the account and specified fields","query":"aws.iam.users {\n  users\n  roles\n  groups\n  policies\n  attachedPolicies\n  accountSummary\n  virtualMfaDevices\n  serverCertificates\n}\n"},{"title":"Return a list of users that do not have MFA configured along with the ARN, name, and associated IAM Groups","query":"aws.iam.credentialReport.where(mfaActive == false) { \n  user { \n    arn \n    name \n    groups \n  }\n}\n"},{"title":"Do not setup access keys during initial user setup for all IAM users that have a console password","query":"aws.iam.credentialReport.\n  where(\n    passwordEnabled \u0026\u0026\n    accessKey1Active \u0026\u0026\n    userCreationTime \u003c time.today\n  ).\n  all(\n    accessKey1LastUsedDate != null\n  ) \n"}],"min_mondoo_version":"5.15.0"},"aws.iam.group":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.iam.group` provides fields for assessing the configuration of IAM Groups. For usage see the `aws.iam` resource documentation.\n"},"fields":{"arn":{},"createDate":{},"id":{},"name":{},"usernames":{}},"min_mondoo_version":"5.15.0"},"aws.iam.policy":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.iam.policy` provides fields for assessing the configuration of individual IAM Policies. For usage see the `aws.iam` resource documentation.\n"},"fields":{"arn":{},"attachedGroups":{},"attachedRoles":{},"attachedUsers":{},"attachmentCount":{},"createDate":{},"defaultVersion":{},"description":{},"id":{},"isAttachable":{},"name":{},"scope":{},"updateDate":{},"versions":{}},"min_mondoo_version":"5.15.0"},"aws.iam.policyversion":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.iam.policyversion` provides fields for assessing the metadata for IAM Policy versions. For usage see the `aws.iam` resource documentation.\n"},"fields":{"arn":{},"createDate":{},"document":{},"isDefaultVersion":{},"versionId":{}},"min_mondoo_version":"5.15.0"},"aws.iam.role":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.iam.role` provides fields for assessing the configuration of individual IAM Roles. For usage see the `aws.iam` resource documentation.\n"},"fields":{"arn":{},"createDate":{},"description":{},"id":{},"name":{},"tags":{}},"min_mondoo_version":"5.15.0"},"aws.iam.user":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.iam.user` provides fields for assessing the configuration of individual IAM users. For usage see the `aws.iam` resource documentation.\n"},"fields":{"accessKeys":{},"arn":{},"attachedPolicies":{},"createDate":{},"groups":{},"id":{},"name":{},"passwordLastUsed":{},"policies":{},"tags":{}},"min_mondoo_version":"5.15.0"},"aws.iam.usercredentialreportentry":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.iam.credentialreportentry` provides fields for assessing the metadata for individual IAM Credential Report entries. For usage see the `aws.iam` resource documentation.\n"},"fields":{"accessKey1Active":{},"accessKey1LastRotated":{},"accessKey1LastUsedDate":{},"accessKey1LastUsedRegion":{},"accessKey1LastUsedService":{},"accessKey2Active":{},"accessKey2LastRotated":{},"accessKey2LastUsedDate":{},"accessKey2LastUsedRegion":{},"accessKey2LastUsedService":{},"arn":{},"cert1Active":{},"cert1LastRotated":{},"cert2Active":{},"cert2LastRotated":{},"mfaActive":{},"passwordEnabled":{},"passwordLastChanged":{},"passwordLastUsed":{},"passwordNextRotation":{},"properties":{},"user":{},"userCreationTime":{}},"min_mondoo_version":"5.15.0"},"aws.iam.virtualmfadevice":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.iam.virtualmfadevice` provides fields for assessing the metadata for individual virtual MFA devices associated with IAM users. For usage see the `aws.iam` resource documentation.\n"},"fields":{"enableDate":{},"serialNumber":{},"user":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.kms":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.kms` resource can be used to assess the configuration of AWS KMS keys. \n"},"fields":{"keys":{}},"snippets":[{"title":"Ensure rotation for customer created CMKs is enabled","query":"aws.kms.keys.where( metadata['KeyState'] == \"Enabled\" ).all( keyRotationEnabled == true )\n"}],"min_mondoo_version":"5.15.0"},"aws.kms.key":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.kms.key` provides fields for assessing the configuration of individual KMS keys. For usage see the `aws.kms` resource documentation.\n"},"fields":{"arn":{},"id":{},"keyRotationEnabled":{},"metadata":{},"region":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.lambda":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.lambda` resource can be used to assess the configuration of AWS Lambda. \n"},"fields":{"functions":{}},"min_mondoo_version":"5.15.0"},"aws.lambda.function":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.lambda.function` provides fields for assessing the configuration of individual AWS Lambda functions. For usage see the `aws.lambda` resource documentation.\n"},"fields":{"arn":{},"concurrency":{},"dlqTargetArn":{},"name":{},"policy":{},"region":{},"tags":{},"vpcConfig":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.organization":{"platform":{"name":["aws"]},"fields":{"arn":{},"featureSet":{},"masterAccountEmail":{},"masterAccountId":{}},"min_mondoo_version":"6.11.0"},"aws.rds":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.rds` resource can be used to assess the configuration of AWS RDS deployments. The resource returns lists of `aws.rds.dbcluster`, `aws.rds.dbinstance`, and `aws.rds.snapshot` resources, each with fields for assessing the configuration of those assets.\n"},"fields":{"dbClusters":{},"dbInstances":{}},"refs":[{"title":"Security in Amazon RDS","url":"https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.html"}],"snippets":[{"title":"Checks whether RDS DB instances have backups enabled","query":"aws.rds.dbInstances.all(snapshots.length \u003e 0)"},{"title":"Checks whether high availability is enabled for all rds instances","query":"aws.rds.dbInstances.all(multiAZ == true)"},{"title":"Return a list of RDS Clusters across all regions where snapshots are not encrypted and return the `arn` `region` and `id` for the cluster","query":"aws.rds.dbClusters { snapshots.where( encrypted == false) } { arn region id }"}],"min_mondoo_version":"5.15.0"},"aws.rds.dbcluster":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.rds.dbcluster` provides fields for assessing the configuration of AWS RDS Clusters.\n"},"fields":{"arn":{},"id":{},"members":{},"region":{},"snapshots":{},"tags":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.rds.dbinstance":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.rds.dbinstance` fields for assessing the configuration of RDS instances. For usage see the `aws.rds` resource documentation.\n"},"fields":{"arn":{},"backupRetentionPeriod":{},"dbInstanceClass":{"min_mondoo_version":"5.19.1"},"dbInstanceIdentifier":{"min_mondoo_version":"5.19.1"},"deletionProtection":{},"enabledCloudwatchLogsExports":{},"engine":{"min_mondoo_version":"5.19.1"},"enhancedMonitoringResourceArn":{},"id":{},"multiAZ":{},"name":{},"publiclyAccessible":{},"region":{},"securityGroups":{"min_mondoo_version":"5.19.1"},"snapshots":{},"status":{"min_mondoo_version":"5.19.1"},"storageEncrypted":{},"tags":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.rds.snapshot":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.rds.snapshot` fields for assessing the configuration of RDS snapshots. For usage see the `aws.rds` resource documentation.\n"},"fields":{"arn":{},"attributes":{},"encrypted":{},"id":{},"isClusterSnapshot":{},"region":{},"tags":{},"type":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.redshift":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.redshift` resource can be used to assess the configuration of AWS RedShift deployments. The resource returns lists of `aws.rds.dbcluster`, `aws.rds.dbinstance`, and `aws.rds.snapshot` resources, each with fields for assessing the configuration of those assets.\n"},"fields":{"clusters":{}},"refs":[{"title":"Amazon Redshift security overview","url":"https://docs.aws.amazon.com/redshift/latest/dg/c_security-overview.html"}],"snippets":[{"title":"Return a list of Amazon RedShift clusters deployed across all enabled regions and the values for specified fields","query":"aws.redshift.clusters {\n  arn\n  encrypted\n  nodeType\n  allowVersionUpgrade\n  preferredMaintenanceWindow\n  automatedSnapshotRetentionPeriod\n  publiclyAccessible\n  parameters\n  logging\n  name\n  region\n  clusterParameterGroupNames\n}\n"},{"title":"Return a list of RedShift clusters that are not encrypted and the values for the `arn` `region` and `name` fields","query":"aws.redshift.clusters.where( encrypted == false ) {\n  arn\n  region\n  name\n}\n"}],"min_mondoo_version":"5.15.0"},"aws.redshift.cluster":{"platform":{"name":["aws"]},"fields":{"allowVersionUpgrade":{},"arn":{},"automatedSnapshotRetentionPeriod":{},"clusterParameterGroupNames":{},"encrypted":{},"logging":{},"name":{},"nodeType":{},"parameters":{},"preferredMaintenanceWindow":{},"publiclyAccessible":{},"region":{},"tags":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.s3":{"platform":{"name":["aws"]},"docs":{"desc":"Amazon Simple Storage Service (Amazon S3) is an object storage service\n"},"fields":{"buckets":{}},"refs":[{"title":"Amazon S3 Product Page","url":"https://aws.amazon.com/s3/"},{"title":"AWS Documentation: What is Amazon S3?","url":"https://docs.aws.amazon.com/AmazonS3/latest/userguide/Welcome.html"}],"snippets":[{"title":"Return a list of AWS S3 buckets and the value for specified fields","query":"aws.s3.buckets {\n  arn\n  name\n  policy\n  tags\n  acl\n  owner\n  public\n  cors\n  location\n  versioning\n  logging\n  staticWebsiteHosting\n  defaultLock\n  replication\n  encryption\n  publicAccessBlock\n  exists\n}\n"},{"title":"Return a list of AWS S3 buckets that are public and return the values for the `arn` `name` `location` `tags` and `publicAccessBlock`","query":"aws.s3.buckets.where( public == true ) {\n  arn\n  name\n  location\n  tags\n  publicAccessBlock \n}\n"},{"title":"Checks whether S3 buckets have cross-region replication enabled","query":"aws.s3.buckets.all( \n  replication['Rules'] { _['Status'] == \"Enabled\" }\n)\n"},{"title":"Checks that all buckets are encrypted with kms","query":"aws.s3.buckets.all( \n  encryption['Rules'] { _['ApplyServerSideEncryptionByDefault']['KMSMasterKeyID'] == /^arn:aws:kms:.*/}\n)\n"}],"min_mondoo_version":"5.15.0"},"aws.s3.bucket":{"platform":{"name":["aws"]},"docs":{"desc":"The `aws.s3.bucket` resource provides fields for assessing the configuration of AWS S3 buckets. For usage see the `aws.s3` resource documentation.\n"},"fields":{"acl":{},"arn":{},"cors":{},"defaultLock":{},"encryption":{},"exists":{},"location":{},"logging":{},"name":{},"owner":{},"policy":{},"public":{},"publicAccessBlock":{},"replication":{},"staticWebsiteHosting":{},"tags":{},"versioning":{}},"refs":[{"title":"Amazon S3 Product Page","url":"https://aws.amazon.com/s3/"},{"title":"AWS Documentation: Buckets overview","url":"https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingBucket.html"}],"is_private":true,"min_mondoo_version":"5.15.0"},"aws.s3.bucket.corsrule":{"platform":{"name":["aws"]},"fields":{"allowedHeaders":{},"allowedMethods":{},"allowedOrigins":{},"exposeHeaders":{},"maxAgeSeconds":{},"name":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.s3.bucket.grant":{"platform":{"name":["aws"]},"fields":{"grantee":{},"id":{},"name":{},"permission":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.s3.bucket.policy":{"platform":{"name":["aws"]},"docs":{"desc":"Bucket policies grant permission to your Amazon S3 resources\n"},"fields":{"document":{},"id":{},"name":{},"statements":{},"version":{}},"refs":[{"title":"AWS Documentation: Using bucket policies","url":"https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-policies.html"}],"is_private":true,"min_mondoo_version":"5.15.0"},"aws.s3control":{"platform":{"name":["aws"]},"fields":{"accountPublicAccessBlock":{}},"min_mondoo_version":"5.15.0"},"aws.sagemaker":{"platform":{"name":["aws"]},"fields":{"endpoints":{},"notebookInstances":{}},"min_mondoo_version":"5.15.0"},"aws.sagemaker.endpoint":{"platform":{"name":["aws"]},"fields":{"arn":{},"config":{},"name":{},"region":{},"tags":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.sagemaker.notebookinstance":{"platform":{"name":["aws"]},"fields":{"arn":{},"details":{},"name":{},"region":{},"tags":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.sagemaker.notebookinstance.details":{"platform":{"name":["aws"]},"fields":{"arn":{},"directInternetAccess":{},"kmsKey":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.secretsmanager":{"platform":{"name":["aws"]},"fields":{"secrets":{}},"min_mondoo_version":"5.15.0"},"aws.secretsmanager.secret":{"platform":{"name":["aws"]},"fields":{"arn":{},"name":{},"rotationEnabled":{},"tags":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.securityhub":{"platform":{"name":["aws"]},"fields":{"hubs":{}},"min_mondoo_version":"5.15.0"},"aws.securityhub.hub":{"platform":{"name":["aws"]},"fields":{"arn":{},"subscribedAt":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.sns":{"platform":{"name":["aws"]},"fields":{"topics":{}},"min_mondoo_version":"5.15.0"},"aws.sns.subscription":{"platform":{"name":["aws"]},"fields":{"arn":{},"protocol":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.sns.topic":{"platform":{"name":["aws"]},"fields":{"arn":{},"attributes":{},"region":{},"subscriptions":{},"tags":{"min_mondoo_version":"5.23.0"}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.vpc":{"platform":{"name":["aws"]},"fields":{"arn":{},"flowLogs":{},"id":{},"isDefault":{},"region":{},"routeTables":{},"state":{},"tags":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.vpc.flowlog":{"platform":{"name":["aws"]},"fields":{"id":{},"region":{},"status":{},"tags":{},"vpc":{}},"is_private":true,"min_mondoo_version":"5.15.0"},"aws.vpc.routetable":{"platform":{"name":["aws"]},"fields":{"id":{},"routes":{}},"is_private":true,"min_mondoo_version":"5.15.0"}}}