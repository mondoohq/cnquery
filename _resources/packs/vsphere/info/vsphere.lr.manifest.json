{"resources":{"esxi":{"maturity":"deprecated","platform":{"name":["vmware-esxi","vmware-vsphere"]},"docs":{"desc":"The `esxi.host` and `esxi.vm` resource is deprecated. Please use `vsphere.host` and `vsphere.vm` instead.\n"},"fields":{"host":{},"vm":{}},"snippets":[{"title":"Check that all kernel modules are signed","query":"esxi.host {\n  kernelModules {\n    signedStatus == \"Signed\"\n  }\n}\n"}],"min_mondoo_version":"5.15.0"},"esxi.command":{"platform":{"name":["vmware-esxi","vmware-vsphere"]},"fields":{"command":{},"inventoryPath":{},"result":{}},"min_mondoo_version":"5.27.0"},"esxi.kernelmodule":{"platform":{"name":["vmware-esxi","vmware-vsphere"]},"fields":{"enabled":{},"license":{},"loaded":{},"modulefile":{},"name":{},"signatureDigest":{},"signatureFingerprint":{},"signedStatus":{},"version":{},"vibAcceptanceLevel":{}},"min_mondoo_version":"5.15.0"},"esxi.ntpconfig":{"platform":{"name":["vmware-esxi","vmware-vsphere"]},"fields":{"config":{},"id":{},"server":{}},"min_mondoo_version":"5.15.0"},"esxi.service":{"platform":{"name":["vmware-esxi","vmware-vsphere"]},"fields":{"key":{},"label":{},"policy":{},"required":{},"ruleset":{},"running":{},"uninstallable":{}},"min_mondoo_version":"5.15.0"},"esxi.timezone":{"platform":{"name":["vmware-esxi","vmware-vsphere"]},"fields":{"description":{},"key":{},"name":{},"offset":{}},"min_mondoo_version":"5.15.0"},"esxi.vib":{"platform":{"name":["vmware-esxi","vmware-vsphere"]},"fields":{"acceptanceLevel":{},"creationDate":{},"id":{},"installDate":{},"name":{},"status":{},"vendor":{},"version":{}},"min_mondoo_version":"5.15.0"},"vsphere":{"platform":{"name":["vmware-esxi","vmware-vsphere"]},"fields":{"about":{},"datacenters":{},"licenses":{}},"snippets":[{"title":"Display Information about the vSphere environment","query":"vsphere.about"},{"title":"Display ESXi host moid and properties","query":"vsphere.datacenters { hosts { moid properties } }"},{"title":"Display NTP server for all ESXi hosts","query":"vsphere.datacenters { hosts { ntp.server } }"},{"title":"Ensure a specific NTP Server is set","query":"vsphere.datacenters { hosts { ntp.server.any(_ == \"10.31.21.2\") } }"},{"title":"Ensure specific VmkNics properties for all management VmkNics","query":"vsphere.datacenters {\n  hosts {\n    vmknics.where(tags == \"Management\") {\n      properties['Enabled'] == true\n      properties['MTU'] == 1500\n      properties['VDSName'] != /(?i)storage/\n    }\n  }\n}\n"}],"min_mondoo_version":"5.15.0"},"vsphere.cluster":{"platform":{"name":["vmware-esxi","vmware-vsphere"]},"fields":{"hosts":{},"inventoryPath":{},"moid":{},"name":{},"properties":{}},"min_mondoo_version":"5.15.0"},"vsphere.datacenter":{"platform":{"name":["vmware-esxi","vmware-vsphere"]},"fields":{"clusters":{},"hosts":{},"inventoryPath":{},"moid":{},"name":{},"vms":{}},"min_mondoo_version":"5.15.0"},"vsphere.host":{"platform":{"name":["vmware-esxi","vmware-vsphere"]},"fields":{"acceptanceLevel":{},"adapters":{},"advancedSettings":{},"distributedSwitch":{},"inventoryPath":{},"kernelModules":{},"moid":{},"name":{},"ntp":{},"packages":{},"properties":{},"services":{},"snmp":{},"standardSwitch":{},"timezone":{},"vmknics":{}},"snippets":[{"title":"Verify the Software AcceptanceLevel for ESXi host","query":"// targeting a single ESXi host\nesxi.host {\n  acceptanceLevel == 'VMwareCertified' || acceptanceLevel == 'VMwareAccepted' || acceptanceLevel == 'PartnerSupported'\n}\n\n// targeting the vSphere API\nvsphere.datacenters {\n  hosts {\n    acceptanceLevel == 'VMwareCertified' || acceptanceLevel == 'VMwareAccepted' || acceptanceLevel == 'PartnerSupported'\n  }\n}\n"},{"title":"Verify that each vib is \"VMwareCertified\" or \"VMwareAccepted\"","query":"esxi.host {\n  packages {\n    acceptanceLevel == 'VMwareCertified' || acceptanceLevel == 'VMwareAccepted' || acceptanceLevel == 'PartnerSupported'\n  }\n}\n"}],"min_mondoo_version":"5.15.0"},"vsphere.license":{"platform":{"name":["vmware-esxi","vmware-vsphere"]},"fields":{"name":{},"total":{},"used":{}},"min_mondoo_version":"5.15.0"},"vsphere.vm":{"platform":{"name":["vmware-esxi","vmware-vsphere"]},"fields":{"advancedSettings":{},"inventoryPath":{},"moid":{},"name":{},"properties":{}},"min_mondoo_version":"5.15.0"},"vsphere.vmknic":{"platform":{"name":["vmware-esxi","vmware-vsphere"]},"fields":{"ipv4":{},"ipv6":{},"name":{},"properties":{},"tags":{}},"min_mondoo_version":"5.15.0"},"vsphere.vmnic":{"platform":{"name":["vmware-esxi","vmware-vsphere"]},"fields":{"details":{},"name":{},"pauseParams":{},"properties":{}},"min_mondoo_version":"5.15.0"},"vsphere.vswitch.dvs":{"platform":{"name":["vmware-esxi","vmware-vsphere"]},"fields":{"name":{},"properties":{},"uplinks":{}},"min_mondoo_version":"5.15.0"},"vsphere.vswitch.standard":{"platform":{"name":["vmware-esxi","vmware-vsphere"]},"fields":{"failoverPolicy":{},"name":{},"properties":{},"securityPolicy":{},"shapingPolicy":{},"uplinks":{}},"min_mondoo_version":"5.15.0"}}}